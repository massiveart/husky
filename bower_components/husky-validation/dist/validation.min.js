define("form/util",[],function(){var e=["form","validation"];return{debugEnabled:!1,getFields:function(e){return $(e).find('input:not([data-form="false"], [type="submit"], [type="button"]), textarea:not([data-form="false"]), select:not([data-form="false"]), *[data-form="true"]')},parseData:function(e,t,n){var r=$(e);return this.buildOptions(r.data(),t,"",n)},buildOptions:function(t,n,r,i){r||(r=""),i||(i={});var s=$.extend({},i,{}),o=n+this.ucFirst(r);return $.each(t,function(t,r){var i=new RegExp("^"+o);i.test(t)&&$.inArray(t,e)===-1&&(t!==o?t=t.replace(i,""):t=t.replace(new RegExp("^"+n),""),t!==""&&(t=this.lcFirst(t),s[t]=r))}.bind(this)),s},debug:function(e,t,n){!this.debugEnabled||(e?t?n?console.log("Husky Validation:",e,t,n):console.log("Husky Validation:",e,t):console.log("Husky Validation:",e):console.log("Husky Validation"))},ucFirst:function(e){e+="";var t=e.charAt(0).toUpperCase();return t+e.substr(1)},lcFirst:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},startsWith:function(e,t){return e.indexOf(t)===0},print:function(e,t){t||(t=1);var n="",r="&nbsp;&nbsp;&nbsp;&nbsp;",i,s,o="",u=0;while(u<t)o+=r,u++;for(i in e)e.hasOwnProperty(i)&&(s=e[i],typeof s=="string"?this.isNumeric(s)?n+=o+i+": "+s+"; </br>":(s.length>7&&(s=s.substring(0,6)+" ..."),n+=o+i+": '"+s+"'; </br>"):n+=o+i+": { </br>"+o+r+print(s,t++)+"}");return n},isNumeric:function(e){return e.match(/-?\d+(.\d+)?/)}}}),define("form/element",["form/util"],function(e){return function(t,n,r){var i={type:"string",validationTrigger:"focusout",validationAddClasses:!0,validationAddClassesParent:!0,validationSuccessClass:"husky-validate-success",validationErrorClass:"husky-validate-error",validationClass:"husky-validate",validation:!0},s=["validation","validationTrigger","validationAddClasses","validationAddClassesParent","validationClass","validationSuccessClass","validationErrorClass","validationSubmitEvent"],o,u={},a,f=null,l=null,c={initialize:function(){l=$.Deferred(),this.requireCounter=0,this.initialized=l.promise(),this.$el=$(t),this.$el.data("element",this),this.options=$.extend({},i,r),!this.options.validationAddClasses||this.$el.addClass(this.options.validationClass),!this.options.validation||c.initValidation.call(this)},resolveInitialization:function(){this.requireCounter--,this.requireCounter===0&&l.resolve()},initValidation:function(){c.bindValidationDomEvents.call(this),c.initValidators.call(this),c.initType.call(this)},bindValidationDomEvents:function(){var e=this.options.validationTrigger?this.options.validationTrigger:"";if(e===""||e==="none")return;this.$el.is("select")&&(e+=(new RegExp("change","i")).test(e)?"":" change"),e=e.replace(/^\s+/g,"").replace(/\s+$/g,""),this.$el.bind(e,this.validate.bind(this))},initValidators:function(){$.each(this.options,function(t,r){if(!!r&&$.inArray(t,s)===-1&&e.startsWith(t,"validation")){var i=e.lcFirst(t.replace("validation",""));this.requireCounter++,require(["validator/"+i],function(r){var s=e.buildOptions(this.options,"validation",i);u[i]=new r(this.$el,n,s),e.debug("Element Validator",t,s),c.resolveInitialization.call(this)}.bind(this))}}.bind(this))},initType:function(){!this.options.type||(this.requireCounter++,require(["type/"+this.options.type],function(t){var n=e.buildOptions(this.options,"type");a=new t(this.$el,n),e.debug("Element Type",a,n),c.resolveInitialization.call(this)}.bind(this)))},hasConstraints:function(){return Object.keys(u).length>0||a!==null&&a.needsValidation()},needsValidation:function(){return f!==this.$el.val()},reset:function(){var e=this.$el;!this.options.validationAddClassesParent||(e=e.parent()),e.removeClass(this.options.validationSuccessClass),e.removeClass(this.options.validationErrorClass)},setValid:function(e){o=e;if(!!this.options.validationAddClasses){c.reset.call(this);var t=this.$el;!this.options.validationAddClassesParent||(t=t.parent()),e?t.addClass(this.options.validationSuccessClass):t.addClass(this.options.validationErrorClass)}}},h={validate:function(e){if(e||c.needsValidation.call(this)){if(!c.hasConstraints.call(this))return c.reset.call(this),!0;var t=!0;$.each(u,function(e,n){n.validate()||(t=!1)}),a!==null&&!a.validate()&&(t=!1),c.setValid.call(this,t)}return this.isValid()},isValid:function(){return o},updateConstraint:function(e,t){if(!($.inArray(e,Object.keys(u))>-1))throw"No constraint with name: "+e;u[e].updateConstraint(t),this.validate()},deleteConstraint:function(e){if(!($.inArray(e,Object.keys(u))>-1))throw"No constraint with name: "+e;delete u[e],this.validate(!0)},addConstraint:function(e,t){if($.inArray(e,Object.keys(u))!==-1)throw"Constraint with name: "+e+" already exists";require(["validator/"+e],function(r){u[e]=new r(this.$el,n,t)}.bind(this))},setValue:function(e){a.setValue(e)},getValue:function(e){return a.getValue(e)}};return c.initialize.call(h),h}}),define("form/validation",["form/util"],function(e){return function(t){var n,r={initialize:function(){r.bindValidationDomEvents.call(this),e.debug("INIT Validation")},bindValidationDomEvents:function(){!t.options.validationSubmitEvent||t.$el.on("submit",function(){return t.validation.validate()}.bind(this))},setValid:function(e){n=e}},i={validate:function(n){var i=!0;return $.each(t.elements,function(e,t){t.validate(n)||(i=!1)}),r.setValid.call(this,i),e.debug("Validation",i?"success":"error"),i},isValid:function(){return n},updateConstraint:function(e,t,n){var r=$(e);if(!r.data("element"))throw"No validation element";$(e).data("element").updateConstraint(t,n)},deleteConstraint:function(e,t){var n=$(e);if(!n.data("element"))throw"No validation element";n.data("element").deleteConstraint(t)},addConstraint:function(e,n,r){var i=$(e),s;i.data("element")?i.data("element").addConstraint(n,r):(s=t.addField(e),s.addConstraint(n,r),t.elements.push(s))}};return r.initialize.call(i),i}}),define("form/mapper",["form/util"],function(e){return function(t){var n={initialize:function(){e.debug("INIT Mapper")},processData:function(e){var n=$(e),r=n.data("type"),i=n.data("element"),s;return r!=="array"?i.getValue():(s=[],$.each(n.children(),function(e,n){s.push(t.mapper.getData($(n)))}),s)},setArrayData:function(n,r){var i=r.children().first(),s;$.each(e.getFields(r),function(e,n){t.removeField(n)}.bind(this)),r.children().remove(),$.each(n,function(n,o){var u=i.clone(),a=e.getFields(u),f=$.Deferred(),l=a.length;r.append(u),f.then(function(){t.mapper.setData(o,u)}),$.each(a,function(e,n){s=t.addField($(n)),s.initialized.then(function(){l--,l===0&&f.resolve()})}.bind(this))})}},r={setData:function(e,r){r||(r=t.$el),$.each(e,function(e,i){var s='*[data-mapper-property="'+e+'"]',o=r.find(s),u=o.data("element");o.length>0&&($.isArray(i)?n.setArrayData.call(this,i,o):u?u.setValue(i):(u=t.addField(o),u.initialized.then(function(){u.setValue(i)})))}.bind(this))},getData:function(e){e||(e=t.$el);var r={},i,s,o,u="*[data-mapper-property]",a=e.find(u);while(a.length>0)i=$(a.get(0)),s=i.data("mapper-property"),s.match(/.*\..*/)?(o=s.split("."),r[o[0]]={},r[o[0]][o[1]]=n.processData.call(this,i)):r[s]=n.processData.call(this,i),a=a.not(i),a=a.not(i.find(u));return r}};return n.initialize.call(r),r}}),require.config({paths:{form:"js/form","form/mapper":"js/mapper","form/validation":"js/validation","form/element":"js/element","form/util":"js/util","type/default":"js/types/default","type/string":"js/types/string","type/date":"js/types/date","type/decimal":"js/types/decimal","type/email":"js/types/email","type/url":"js/types/url","type/label":"js/types/label","validator/default":"js/validators/default","validator/min":"js/validators/min","validator/max":"js/validators/max","validator/minLength":"js/validators/min-length","validator/maxLength":"js/validators/max-length","validator/required":"js/validators/required","validator/unique":"js/validators/unique"}}),define("form",["form/element","form/validation","form/mapper","form/util"],function(e,t,n,r){return function(i,s){var o={debug:!1,validation:!0,validationTrigger:"focusout",validationAddClassesParent:!0,validationAddClasses:!0,validationSubmitEvent:!0,mapper:!0},u={initialize:function(){this.$el=$(i),this.options=$.extend(o,this.$el.data(),s),r.debugEnabled=this.options.debug,u.initFields.call(this),!this.options.validation||(this.validation=new t(this)),!this.options.mapper||(this.mapper=new n(this)),this.$el.data("form-object",this),r.debug("Form",this),r.debug("Elements",this.elements)},initFields:function(){$.each(r.getFields(this.$el),function(e,t){this.addField.call(this,t)}.bind(this))},bindValidationDomEvents:function(){!this.options.validationSubmitEvent||this.$el.on("submit",function(){return this.validation.validate()}.bind(this))}},a={elements:[],options:{},validation:!1,mapper:!1,addField:function(t){var n=$(t),i=r.parseData(n,"",this.options),s=new e(n,this,i);return this.elements.push(s),r.debug("Element created",i),s},removeField:function(e){var t=$(e),n=t.data("element");this.elements.splice(this.elements.indexOf(n),1)}};return u.initialize.call(a),a}}),define("type/default",[],function(){return function(e,t,n,r,i){var s={initialize:function(){this.$el=e,this.options=$.extend({},t,n),!this.initializeSub||this.initializeSub()}},o={name:r,needsValidation:function(){return!0},updateConstraint:function(e){$.extend(this.options,e)},setValue:function(e){this.$el.val(this.getViewData.call(this,e))},getValue:function(){return this.getModelData.call(this,this.$el.val())},getViewData:function(e){return e},getModelData:function(e){return e}},u=$.extend({},o,i);return s.initialize.call(u),u}}),define("type/string",["type/default"],function(e){return function(t,n){var r={},i={needsValidation:function(){return!1},validate:function(){return!0}};return new e(t,r,n,"string",i)}}),define("type/date",["type/default"],function(e){return function(t,n){var r={format:"d"},i=function(e){return console.log(e,new Date(e)),new Date(e)},s={validate:function(){var e=this.$el.val(),t;return e===""?!0:(t=Globalize.parseDate(e,this.options.format),t!==null)},getViewData:function(e){return Globalize.format(i(e),this.options.format)},getModelData:function(e){if(e!==""){var t=Globalize.parseDate(e,this.options.format);return t.toISOString()}return e}};return new e(t,r,n,"date",s)}}),define("type/decimal",["type/default"],function(e){return function(t,n){var r={regExp:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/},i={initializeSub:function(){},validate:function(){var e=this.$el.val();return e===""?!0:this.options.regExp.test(this.$el.val())}};return new e(t,r,n,"decimal",i)}}),define("type/email",["type/default"],function(e){return function(t,n){var r={regExp:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))){2,6}$/i},i={validate:function(){var e=this.$el.val();return e===""?!0:this.options.regExp.test(this.$el.val())}};return new e(t,r,n,"email",i)}}),define("type/url",["type/default"],function(e){return function(t,n){var r={regExp:/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},i={validate:function(){var e=this.$el.val();return e===""?!0:(this.options["url-strict"]!=="true"&&(e=(new RegExp("(https?|s?ftp|git)","i")).test(e)?e:"http://"+e),this.options.regExp.test(e))}};return new e(t,r,n,"email",i)}}),define("type/label",["type/default"],function(e){return function(t,n){var r={id:"id",label:"name"},i={setValue:function(e){!e[this.options.label]||this.$el.text(e[this.options.label]),!e[this.options.id]||this.$el.data(this.options.id,e[this.options.id])},getValue:function(){var e={};return e[this.options.id]=this.$el.data(this.options.id),e[this.options.label]=this.$el.text(),e},needsValidation:function(){return!1},validate:function(){return!0}};return new e(t,r,n,"label",i)}}),define("validator/default",[],function(){return function(e,t,n,r,i){return{name:i,initialize:function(){this.$el=e,this.data=$.extend(n,this.$el.data(),r),this.updateData(),!this.initializeSub||this.initializeSub()},updateConstraint:function(e){$.extend(this.data,e),this.updateData()},updateData:function(){$.each(this.data,function(e,t){this.$el.data(e,t)}.bind(this))}}}}),define("validator/min",["validator/default"],function(e){return function(t,n,r){var i={min:0},s=$.extend(new e(t,n,i,r,"min"),{validate:function(){var e=this.$el.val();return Number(e)>=this.data.min}});return s.initialize(),s}}),define("validator/max",["validator/default"],function(e){return function(t,n,r){var i={max:999},s=$.extend(new e(t,n,i,r,"max"),{validate:function(){var e=this.$el.val();return Number(e)<=this.data.max}});return s.initialize(),s}}),define("validator/minLength",["validator/default"],function(e){return function(t,n,r){var i={minLength:0},s=$.extend(new e(t,n,i,r,"min-length"),{validate:function(){var e=this.$el.val();return e.length>=this.data.minLength}});return s.initialize(),s}}),define("validator/maxLength",["validator/default"],function(e){return function(t,n,r){var i={maxLength:999},s=$.extend(new e(t,n,i,r,"max-length"),{validate:function(){var e=this.$el.val();return e.length<=this.data.maxLength}});return s.initialize(),s}}),define("validator/required",["validator/default"],function(e){return function(t,n,r){var i={},s=$.extend(new e(t,n,i,r,"required"),{validate:function(e){if(!!this.data.required){var t=e||this.$el.val(),n;if("object"==typeof t){for(n in t)if(this.validate(t[n]))return!0;return!1}return t.length>0&&""!==t.replace(/^\s+/g,"").replace(/\s+$/g,"")}return!0}});return s.initialize(),s}}),define("validator/unique",["validator/default"],function(e){return function(t,n,r){var i={validationUnique:null},s=$.extend({},new e(t,n,i,r,"unique"),{validate:function(){var e=$(t).val(),r=t.data("validation-unique"),i=0;return $.each(n.elements,function(t,n){var s=n.options.validationUnique,o=n.getValue();return r===s&&e===o&&i++,i<=1}),i<=1}});return s.initialize(),s}});