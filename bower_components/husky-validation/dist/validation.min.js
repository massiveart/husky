define("form/util",[],function(){var e=["form","validation"];return{debugEnabled:!1,getFields:function(e){return $(e).find('input:not([data-form="false"], [type="submit"], [type="button"]), textarea:not([data-form="false"]), select:not([data-form="false"]), *[data-form="true"], *[data-type="collection"], *[contenteditable="true"]')},parseData:function(e,t,n){var r=$(e);return this.buildOptions(r.data(),t,"",n)},buildOptions:function(t,n,r,i){r||(r=""),i||(i={});var s=$.extend({},i,{}),o=n+this.ucFirst(r);return $.each(t,function(t,r){var i=new RegExp("^"+o);i.test(t)&&$.inArray(t,e)===-1&&(t!==o?t=t.replace(i,""):t=t.replace(new RegExp("^"+n),""),t!==""&&(t=this.lcFirst(t),s[t]=r))}.bind(this)),s},isValueField:function(e){var t=$(e);return t.is("input, select, textarea, option, button")},getValue:function(e){var t=$(e);return this.isValueField(t)?t.val():t.html()},setValue:function(e,t){var n=$(e);this.isValueField(n)?n.val(t):n.html(t)},debug:function(e,t,n){!this.debugEnabled||(e?t?n?console.log("Husky Validation:",e,t,n):console.log("Husky Validation:",e,t):console.log("Husky Validation:",e):console.log("Husky Validation"))},ucFirst:function(e){e+="";var t=e.charAt(0).toUpperCase();return t+e.substr(1)},lcFirst:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},startsWith:function(e,t){return e.indexOf(t)===0},print:function(e,t){t||(t=1);var n="",r="&nbsp;&nbsp;&nbsp;&nbsp;",i,s,o="",u=0;while(u<t)o+=r,u++;for(i in e)e.hasOwnProperty(i)&&(s=e[i],typeof s=="string"?this.isNumeric(s)?n+=o+i+": "+s+"; </br>":(s.length>7&&(s=s.substring(0,6)+" ..."),n+=o+i+": '"+s+"'; </br>"):n+=o+i+": { </br>"+o+r+print(s,t++)+"}");return n},isNumeric:function(e){return e.match(/-?\d+(.\d+)?/)}}}),define("form/element",["form/util"],function(e){return function(t,n,r){var i={type:null,validationTrigger:"focusout",validationAddClasses:!0,validationAddClassesParent:!0,validationErrorClass:"husky-validate-error",validationClass:"husky-validate",validation:!0},s=["validation","validationTrigger","validationAddClasses","validationAddClassesParent","validationClass","validationErrorClass","validationSubmitEvent"],o,u={},a,f=null,l=null,c={initialize:function(){l=$.Deferred(),this.requireCounter=0,this.initialized=l.promise(),this.$el=$(t),this.$el.data("element",this),this.options=$.extend({},i,r),!this.options.validationAddClasses||this.$el.addClass(this.options.validationClass),!this.options.validation||c.initValidation.call(this)},resolveInitialization:function(){this.requireCounter--,this.requireCounter===0&&l.resolve()},initValidation:function(){c.bindValidationDomEvents.call(this),c.initValidators.call(this),c.initType.call(this)},bindValidationDomEvents:function(){var e=this.options.validationTrigger?this.options.validationTrigger:"";if(e===""||e==="none")return;this.$el.is("select")&&(e+=(new RegExp("change","i")).test(e)?"":" change"),e=e.replace(/^\s+/g,"").replace(/\s+$/g,""),this.$el.bind(e,this.validate.bind(this))},initValidators:function(){var t=function(t,r){this.requireCounter++,require(["validator/"+t],function(i){u[t]=new i(this.$el,n,this,r),e.debug("Element Validator",t,r),c.resolveInitialization.call(this)}.bind(this))}.bind(this);$.each(this.options,function(n,r){if(!!r&&$.inArray(n,s)===-1&&e.startsWith(n,"validation")){var i=e.lcFirst(n.replace("validation","")),o=e.buildOptions(this.options,"validation",i);t(i,o)}}.bind(this)),this.$el.attr("required")==="required"&&!u.required&&t("required",{required:!0}),!!this.$el.attr("min")&&!u.min&&t("min",{min:parseInt(this.$el.attr("min"),10)}),!!this.$el.attr("max")&&!u.max&&t("max",{max:parseInt(this.$el.attr("max"),10)}),!!this.$el.attr("pattern")&&!u.pattern&&t("regex",{regex:this.$el.attr("pattern")})},initType:function(){var t=function(t,r){this.requireCounter++,require(["type/"+t],function(i){a=new i(this.$el,r,n),a.initialized.then(function(){e.debug("Element Type",t,r),c.resolveInitialization.call(this)}.bind(this))}.bind(this))}.bind(this),r=e.buildOptions(this.options,"type"),i,s;this.options.type?i=this.options.type:this.$el.attr("type")?(s=this.$el.attr("type"),s==="email"?i="email":s==="url"?i="url":s==="number"?i="decimal":s==="date"?(i="date",!r.format||(r.format="d")):s==="time"?(i="date",!r.format||(r.format="t")):s==="datetime"?i="date":i="string"):i="string",t(i,r)},hasConstraints:function(){var e=!!a&&a.needsValidation(),t=Object.keys(u).length>0;return t||e},needsValidation:function(){return f!==e.getValue(this.$el)},reset:function(){var e=this.$el;!this.options.validationAddClassesParent||(e=e.parent()),e.removeClass(this.options.validationErrorClass)},setValid:function(e){o=e;if(!!this.options.validationAddClasses){c.reset.call(this);var t=this.$el;!this.options.validationAddClassesParent||(t=t.parent()),e||t.addClass(this.options.validationErrorClass)}}},h={validate:function(t){if(t||c.needsValidation.call(this)){if(!c.hasConstraints.call(this))return!0;var n=!0;$.each(u,function(e,t){t.validate()||(n=!1)}),a!==null&&!a.validate()&&(n=!1),n||e.debug("Field validate",n?"true":"false",this.$el),c.setValid.call(this,n)}return this.isValid()},update:function(){if(!c.hasConstraints.call(this))return!0;var t=!0;return $.each(u,function(e,n){n.update()||(t=!1)}),a!==null&&!a.validate()&&(t=!1),t||e.debug("Field validate",t?"true":"false",this.$el),c.setValid.call(this,t),t},isValid:function(){return o},updateConstraint:function(e,t){if(!($.inArray(e,Object.keys(u))>-1))throw"No constraint with name: "+e;u[e].updateConstraint(t),this.validate()},deleteConstraint:function(e){if(!($.inArray(e,Object.keys(u))>-1))throw"No constraint with name: "+e;delete u[e],this.validate(!0)},addConstraint:function(e,t){if($.inArray(e,Object.keys(u))!==-1)throw"Constraint with name: "+e+" already exists";require(["validator/"+e],function(r){u[e]=new r(this.$el,n,this,t)}.bind(this))},hasConstraint:function(e){return!!u[e]},getConstraint:function(e){return this.hasConstraint(e)?u[e]:!1},fieldAdded:function(e){$.each(u,function(t,n){n.fieldAdded(e)})},fieldRemoved:function(e){$.each(u,function(t,n){n.fieldRemoved(e)})},setValue:function(e){var t=$.Deferred(),n;return this.initialized.then(function(){n=a.setValue(e),n?n.then(function(){t.resolve()}):t.resolve()}.bind(this)),t.promise()},getValue:function(e){return a.getValue(e)},getType:function(){return a}};return c.initialize.call(h),h}}),define("form/validation",["form/util"],function(e){return function(t){var n,r={initialize:function(){r.bindValidationDomEvents.call(this),e.debug("INIT Validation")},bindValidationDomEvents:function(){!t.options.validationSubmitEvent||t.$el.on("submit",function(){return t.validation.validate()}.bind(this))},setValid:function(e){n=e}},i={validate:function(n){var i=!0,s=!1;return $.each(t.elements,function(e,t){t.validate(n)||(s||(t.$el.focus(),s=!0),i=!1)}),r.setValid.call(this,i),e.debug("Validation",i?"success":"error"),i},isValid:function(){return n},updateConstraint:function(e,t,n){var r=$(e);if(!r.data("element"))throw"No validation element";$(e).data("element").updateConstraint(t,n)},deleteConstraint:function(e,t){var n=$(e);if(!n.data("element"))throw"No validation element";n.data("element").deleteConstraint(t)},addConstraint:function(e,n,r){var i=$(e),s;i.data("element")?i.data("element").addConstraint(n,r):(s=t.addField(e),s.addConstraint(n,r),t.elements.push(s))}};return r.initialize.call(i),i}}),define("form/mapper",["form/util"],function(e){return function(t){var n={},r={initialize:function(){e.debug("INIT Mapper"),this.collections=[],this.collectionsSet={},this.templates={},this.elements=[],this.collectionsInitiated=$.Deferred(),t.initialized.then(function(){var e='*[data-type="collection"]',n=t.$el.find(e);n.each(r.initCollection.bind(this))}.bind(this))},initCollection:function(n,i){var s=$(i),o=s.data("element"),u=s.data("mapper-property"),a,f,l=$.Deferred(),c=0,h=function(){c--,c===0&&l.resolve()};if(!$.isArray(u)){if(typeof u!="object")throw"no valid mapper-property value";u=[u],s.data("mapper-property",u)}return o.$children=s.children().clone(!0),s.html(""),f={id:_.uniqueId("collection_"),property:u,$element:s,element:o},this.collections.push(f),c+=o.$children.length,o.$children.each(function(e,t){var n=$(t),i,s,l,c=0,p=function(){c--,c===0&&h()};if(!n.is("script"))throw"template has to be defined as <script>";a={tpl:n.html(),id:n.attr("id"),collection:f},o.$children[e]=a;for(s=-1,l=u.length;++s<l;)u[s].tpl===a.id&&(i=u[s].data);if(!i)p();else{a.propertyName=i,c=f.element.getType().getMinOccurs(),this.templates[i]={tpl:a,collection:f};for(s=f.element.getType().getMinOccurs()+1;--s>0;)r.appendChildren.call(this,f.$element,a).then(function(){$("#current-counter-"+i).text(f.element.getType().getChildren(a.id).length),p()}.bind(this))}}.bind(this)),$.each(u,function(e,n){t.$el.on("click",'*[data-mapper-add="'+n.data+'"]',r.addClick.bind(this)),t.$el.on("click",'*[data-mapper-remove="'+n.data+'"]',r.removeClick.bind(this)),l.then(function(){r.emitInitCollectionEvent(n.data)})}.bind(this)),r.checkFullAndEmpty.call(this,u[0].data),l.then(function(){e.debug("collection resolved")}),l.promise()},addClick:function(e){var t=$(e.currentTarget),n=t.data("mapper-add"),i=this.templates[n].tpl,s=this.templates[n].collection;s.element.getType().canAdd(i.id)&&r.appendChildren.call(this,s.$element,i).then(function(){$("#current-counter-"+n).text(s.element.getType().getChildren(i.id).length),r.emitAddEvent(n,null)}.bind(this)),r.checkFullAndEmpty.call(this,n)},removeClick:function(e){var t=$(e.currentTarget),n=t.data("mapper-remove"),i=this.templates[n].tpl,s=this.templates[n].collection,o=t.closest("."+n+"-element");s.element.getType().canRemove(i.id)&&(r.remove.call(this,o),$("#current-counter-"+n).text(s.element.getType().getChildren(i.id).length),r.emitRemoveEvent(n,null)),r.checkFullAndEmpty.call(this,n)},checkFullAndEmpty:function(e){var t=$("[data-mapper-add='"+e+"']"),n=$("[data-mapper-remove='"+e+"']"),r=this.templates[e].tpl,i=this.templates[e].collection,s=i.element.$el.data("mapper-full-class")||"full",o=i.element.$el.data("mapper-empty-class")||"empty";t.removeClass(s),t.removeClass(o),$(i.element.$el).removeClass(s),$(i.element.$el).removeClass(o);if(!!t.length||!!n.length)i.element.getType().canAdd(r.id)?i.element.getType().canRemove(r.id)||(t.addClass(o),$(i.element.$el).addClass(o)):(t.addClass(s),$(i.element.$el).addClass(s))},emitInitCollectionEvent:function(e){$(t.$el).trigger("form-collection-init",[e])},emitAddEvent:function(e,n){$(t.$el).trigger("form-add",[e,n])},emitRemoveEvent:function(e,n){$(t.$el).trigger("form-remove",[e,n])},processData:function(e,r){var i=$(e),s=i.data("type"),o=i.data("mapper-property"),u=i.data("element"),a,f,l;return r&&!!n[r.data]?l=n[r.data]:!n[o]||(l=n[o]),s!=="collection"?u?u.getValue():null:(a=[],$.each(i.children(),function(e,n){if(!r||r.tpl===n.dataset.mapperPropertyTpl){f=t.mapper.getData($(n)),u.$el.data("mapperProperty").length>1&&(f.mapperId=n.dataset.mapperId);var i=Object.keys(f);i.length===1?f[i[0]]!==""&&a.push(f[i[0]]):(!l||l(f))&&a.push(f)}}),a)},setCollectionData:function(e,t){var n=t.$element,i=t.$child,s=e.length,o=$.Deferred(),u=function(){s--,s===0&&o.resolve()},a,f;if(s===0)o.resolve();else{if(e.length<t.element.getType().getMinOccurs())for(a=t.element.getType().getMinOccurs()+1,f=e.length;--a>f;)e.push({});$.each(e,function(e,t){r.appendChildren.call(this,n,i,t).then(function(e){r.setData.call(this,t,e).then(function(){u()}.bind(this))}.bind(this))}.bind(this))}return $("#current-counter-"+n.attr("id")).text(e.length),r.checkFullAndEmpty.call(this,t.property[0].data),o.promise()},appendChildren:function(n,i,s,o,u){var a=i.collection.element.getType().getChildren(i.id).length,f=$.extend({},{index:a},s||{}),l=_.template(i.tpl,f,t.options.delimiter),c=$(l),h=e.getFields(c),p=$.Deferred(),d=h.length,v;return c.attr("data-mapper-property-tpl",i.id),c.attr("data-mapper-id",_.uniqueId()),$.each(h,function(e,r){v=t.addField($(r)),u?n.after(c):n.append(c),v.initialized.then(function(){d--,d===0&&p.resolve(c)})}.bind(this)),!o||p.then(function(){r.setData.call(this,o,h)}),this.elements.push(c),p.promise()},getElementByMapperId:function(e){for(var t=-1,n=this.elements.length;++t<n;)if(this.elements[t].data("mapper-id")===e)return this.elements[t];return null},deleteElementByMapperId:function(e){for(var t=-1,n=this.elements.length;++t<n;)if(this.elements[t].data("mapper-id")===e)return this.elements[t].remove(),this.elements.splice(t,1),!0;return!1},remove:function(n){$.each(e.getFields(n),function(e,n){t.removeField(n)}.bind(this)),n.remove()},setData:function(e,n){n||(n=t.$el);var i=$.Deferred(),s,o,u,a=1,f=function(){a--,a===0&&i.resolve()};return typeof e!="object"?(s="*[data-mapper-property]",o=n.find(s),u=o.data("element"),u?u.setValue(e).then(function(){f()}):(u=t.addField(o),u.initialized.then(function(){u.setValue(e).then(function(){f()})}.bind(this)))):e!==null&&!$.isEmptyObject(e)?(a=Object.keys(e).length,$.each(e,function(e,i){var o,u,a;$.isArray(i)&&this.templates.hasOwnProperty(e)?(a=this.templates[e].collection,a.$child=this.templates[e].tpl,this.collectionsSet.hasOwnProperty(a.id)||a.$element.children().each(function(e,t){r.remove.call(this,$(t))}.bind(this)),this.collectionsSet[a.id]=!0,r.setCollectionData.call(this,i,a).then(function(){f()})):(s='*[data-mapper-property="'+e+'"]',o=n.andSelf().find(s),u=o.data("element"),o.length>0?u?u.setValue(i).then(function(){f()}):(u=t.addField(o),u.initialized.then(function(){u.setValue(i).then(function(){f()})}.bind(this))):f())}.bind(this))):i.resolve(),i.promise()}},i={setData:function(e,t){return this.collectionsSet={},r.setData.call(this,e,t)},getData:function(e){e||(e=t.$el);var n={},i,s,o,u="*[data-mapper-property]",a=e.find(u);while(a.length>0)i=$(a.get(0)),s=i.data("mapper-property"),$.isArray(s)?$.each(s,function(e,t){n[t.data]=r.processData.call(this,i,t)}):s.match(/.*\..*/)?(o=s.split("."),n[o[0]]={},n[o[0]][o[1]]=r.processData.call(this,i)):n[s]=r.processData.call(this,i),a=a.not(i),a=a.not(i.find(u));return n},addCollectionFilter:function(e,t){n[e]=t},removeCollectionFilter:function(e){delete n[e]},addToCollection:function(e,t,n){var i=this.templates[e],s=i.collection.$element,o=!1,u;!n&&(u=s.find('*[data-mapper-property-tpl="'+i.tpl.id+'"]').last()).length>0&&(s=u,o=!0),r.appendChildren.call(this,s,i.tpl,t,t,o)},editInCollection:function(e,t){var n=r.getElementByMapperId.call(this,e);r.setData.call(this,t,n)},removeFromCollection:function(e){r.deleteElementByMapperId.call(this,e)}};return r.initialize.call(i),i}}),require.config({paths:{form:"js/form","form/mapper":"js/mapper","form/validation":"js/validation","form/element":"js/element","form/util":"js/util","type/default":"js/types/default","type/readonly-select":"js/types/readonlySelect","type/string":"js/types/string","type/date":"js/types/date","type/decimal":"js/types/decimal","type/email":"js/types/email","type/url":"js/types/url","type/label":"js/types/label","type/select":"js/types/select","type/collection":"js/types/collection","type/attributes":"js/types/attributes","validator/default":"js/validators/default","validator/min":"js/validators/min","validator/max":"js/validators/max","validator/minLength":"js/validators/min-length","validator/maxLength":"js/validators/max-length","validator/required":"js/validators/required","validator/unique":"js/validators/unique","validator/equal":"js/validators/equal","validator/regex":"js/validators/regex"}}),define("form",["form/element","form/validation","form/mapper","form/util"],function(e,t,n,r){return function(i,s){var o={debug:!1,delimiter:{interpolate:/<~=(.+?)~>/g,escape:/<~-(.+?)~>/g,evaluate:/<~(.+?)~>/g},validation:!0,validationTrigger:"focusout",validationAddClassesParent:!0,validationAddClasses:!0,validationSubmitEvent:!0,mapper:!0},u={initialize:function(){this.$el=$(i),this.options=$.extend(o,this.$el.data(),s),r.debugEnabled=this.options.debug,this.initialized=u.initFields.call(this),!this.options.validation||(this.validation=new t(this)),!this.options.mapper||(this.mapper=new n(this)),this.$el.data("form-object",this),r.debug("Form",this),r.debug("Elements",this.elements)},initFields:function(e){var t=$.Deferred(),n=0,i=function(){n--,n===0&&t.resolve()};return $.each(r.getFields(e||this.$el),function(e,t){n++,u.addField.call(this,t,!1).initialized.then(i.bind(this))}.bind(this)),t.promise()},bindValidationDomEvents:function(){!this.options.validationSubmitEvent||this.$el.on("submit",function(){return this.validation.validate()}.bind(this))},addField:function(t){var n=$(t),i=r.parseData(n,"",this.options),s=new e(n,this,i);return this.elements.push(s),r.debug("Element created",i),s}},a={elements:[],options:{},validation:!1,mapper:!1,addField:function(e){var t=u.addField.call(this,e);return t.initialized.then(function(){$.each(this.elements,function(e,t){t.fieldAdded(t)})}.bind(this)),t},initFields:function(e){return u.initFields.call(this,e)},removeField:function(e){var t=$(e),n=t.data("element");$.each(this.elements,function(e,t){t.fieldRemoved(n)}),this.elements.splice(this.elements.indexOf(n),1)}};return u.initialize.call(a),a}}),define("type/default",["form/util"],function(e){return function(t,n,r,i,s,o){var u={initialize:function(){this.$el=t,this.options=$.extend({},n,r);var e=$.Deferred();this.requireCounter=0,this.initialized=e.promise(),!this.initializeSub||this.initializeSub(),e.resolve()}},a={name:i,form:o,needsValidation:function(){return!0},updateConstraint:function(e){$.extend(this.options,e)},setValue:function(t){e.setValue(this.$el,this.getViewData.call(this,t))},getValue:function(){return this.getModelData.call(this,e.getValue(this.$el))},getViewData:function(e){return e},getModelData:function(e){return e}},f=$.extend({},a,s);return u.initialize.call(f),f}}),define("type/string",["type/default"],function(e){return function(t,n){var r={},i={needsValidation:function(){return!1},validate:function(){return!0}};return new e(t,r,n,"string",i)}}),define("type/date",["type/default","form/util"],function(e,t){return function(n,r){var i={format:"d"},s=function(e){return t.debug(e,new Date(e)),new Date(e)},o={validate:function(){var e=t.getValue(this.$el),n;return e===""?!0:(n=Globalize.parseDate(e,this.options.format),n!==null)},needsValidation:function(){var e=t.getValue(this.$el);return e!==""},getViewData:function(e){return Globalize.format(s(e),this.options.format)},getModelData:function(e){if(e!==""){var t=Globalize.parseDate(e,this.options.format);return t.toISOString()}return e}};return new e(n,i,r,"date",o)}}),define("type/decimal",["type/default","form/util"],function(e,t){return function(n,r){var i={regExp:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/},s={initializeSub:function(){},validate:function(){var e=t.getValue(this.$el);return e===""?!0:this.options.regExp.test(e)}};return new e(n,i,r,"decimal",s)}}),define("type/email",["type/default","form/util"],function(e,t){return function(n,r){var i={regExp:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))){2,6}$/i},s={validate:function(){var e=t.getValue(this.$el);return e===""?!0:this.options.regExp.test(e)},needsValidation:function(){var e=this.$el.val();return e!==""}};return new e(n,i,r,"email",s)}}),define("type/url",["type/default","form/util"],function(e,t){return function(n,r){var i={regExp:/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},s={validate:function(){var e=t.getValue(this.$el);return e===""?!0:(this.options["url-strict"]!=="true"&&(e=(new RegExp("(https?|s?ftp|git)","i")).test(e)?e:"http://"+e),this.options.regExp.test(e))},needsValidation:function(){var e=t.getValue(this.$el);return e!==""}};return new e(n,i,r,"email",s)}}),define("type/label",["type/default"],function(e){return function(t,n){var r={id:"id",label:"name",translate:!0},i={setValue:function(e){if(!!e[this.options.label]){var t=e[this.options.label],n=e[this.options.label];!this.options.translate||(n=Globalize.localize(t,Globalize.culture().name),n===undefined&&(n=t)),this.$el.text(n)}!e[this.options.id]||this.$el.data(this.options.id,e[this.options.id])},getValue:function(){var e={};return e[this.options.id]=this.$el.data(this.options.id),e[this.options.label]=this.$el.text(),e},needsValidation:function(){return!1},validate:function(){return!0}};return new e(t,r,n,"label",i)}}),define("type/select",["type/default","form/util"],function(e,t){return function(n,r){var i={id:"id",label:"name"},s={setValue:function(e){this.$el.val(e[this.options.id])},getValue:function(){var e={};return e[this.options.id]=t.getValue(this.$el),e[this.options.label]=this.$el.find("option:selected").text(),e},needsValidation:function(){return!1},validate:function(){return!0}};return new e(n,i,r,"select",s)}}),define("type/readonly-select",["type/default"],function(e){return function(t,n){var r={id:null,data:[],idProperty:"id",outputProperty:"name"},i={setValue:function(e){var t=this.options.data,n=this.options.idProperty,r,i;if(typeof e=="object"){if(!e.hasOwnProperty(n))throw"value has no property named "+n;e=e[n]}else if(e===null)return;this.$el.data("id",e);if(t.length>0)for(r=-1,i=t.length;++r<i;)if(t[r].hasOwnProperty(n)&&t[r][n]===e){this.$el.html(t[r][this.options.outputProperty]);break}},getValue:function(){var e=this.$el.data("id"),t,n;for(t=-1,n=this.options.data.length;++t<n;)if(this.options.data[t][this.options.idProperty]===e)return this.options.data[t];return null},needsValidation:function(){return!1},validate:function(){return!0}};return new e(t,r,n,"readonly-select",i)}}),define("type/collection",["type/default"],function(e){return function(t,n){var r={min:0,max:null},i={validate:function(){return!0},needsValidation:function(){return!1},getChildren:function(e){return this.$el.find('*[data-mapper-property-tpl="'+e+'"]')},getMinOccurs:function(){return this.options.min},getMaxOccurs:function(){return this.options.max},canAdd:function(e){var t=this.getChildren(e).length;return this.getMaxOccurs()===null||t<this.getMaxOccurs()},canRemove:function(e){var t=this.getChildren(e).length;return t>this.getMinOccurs()}};return new e(t,r,n,"collection",i)}}),define("type/attributes",["type/default"],function(e){return function(t,n){var r={},i={setValue:function(e){this.$el.data("attributes",e)},getValue:function(){return this.$el.data("attributes")},needsValidation:function(){return!1},validate:function(){return!0}};return new e(t,r,n,"attributes",i)}}),define("validator/default",[],function(){return function(e,t,n,r,i){return{name:i,initialize:function(){this.$el=e,this.data=$.extend(n,this.$el.data(),r),this.updateData(),!this.initializeSub||this.initializeSub()},validate:function(){},update:function(){return this.validate()},updateConstraint:function(e){$.extend(this.data,e),this.updateData()},updateData:function(){$.each(this.data,function(e,t){this.$el.data(e,t)}.bind(this))},fieldRemoved:function(){},fieldAdded:function(){}}}}),define("validator/min",["validator/default","form/util"],function(e,t){return function(n,r,i,s){var o={min:0},u=$.extend(new e(n,r,o,s,"min"),{validate:function(){var e=t.getValue(this.$el);return Number(e)>=this.data.min}});return u.initialize(),u}}),define("validator/max",["validator/default","form/util"],function(e,t){return function(n,r,i,s){var o={max:999},u=$.extend(new e(n,r,o,s,"max"),{validate:function(){var e=t.getValue(this.$el);return Number(e)<=this.data.max}});return u.initialize(),u}}),define("validator/minLength",["validator/default","form/util"],function(e,t){return function(n,r,i,s){var o={minLength:0},u=$.extend(new e(n,r,o,s,"min-length"),{validate:function(){var e=t.getValue(this.$el);return e.length>=this.data.minLength}});return u.initialize(),u}}),define("validator/maxLength",["validator/default","form/util"],function(e,t){return function(n,r,i,s){var o={maxLength:999},u=$.extend(new e(n,r,o,s,"max-length"),{validate:function(){var e=t.getValue(this.$el);return e.length<=this.data.maxLength}});return u.initialize(),u}}),define("validator/required",["validator/default","form/util"],function(e,t){return function(n,r,i,s){var o={},u=$.extend(new e(n,r,o,s,"required"),{validate:function(e){if(!!this.data.required){var n=e||t.getValue(this.$el),r;if("object"==typeof n){for(r in n)if(n.hasOwnProperty(r)&&this.validate(n[r]))return!0;return!1}return n.length>0&&""!==n.replace(/^\s+/g,"").replace(/\s+$/g,"")}return!0}});return u.initialize(),u}}),define("validator/unique",["validator/default","form/util"],function(e,t){return function(n,r,i,s){var o={validationUnique:null},u=[],a=function(e,t){return u.indexOf(e)&&!!e.options.validationUnique&&e.options.validationUnique===t},f=function(e){var t=!0;return $.each(u,function(n,r){return l(e,r)?!0:(t=!1,!1)}),t},l=function(e,t){return e!==t.getValue()},c=function(){$.each(u,function(e,t){t.update()})},h=$.extend({},new e(n,r,o,s,"unique"),{initializeSub:function(){i.initialized.then(function(){$.each(r.elements,function(e,t){this.fieldAdded(t)}.bind(this))}.bind(this))},validate:function(){var e=t.getValue(this.$el),n;if(!this.data.unique)throw"No option group set";return n=f(e),c(),n},update:function(){var e=t.getValue(this.$el),n;if(!this.data.unique)throw"No option group set";return n=f(e),n},fieldAdded:function(e){e.$el!==this.$el&&a(e,this.data.unique)&&(t.debug("field added",this.$el),u.push(e))},fieldRemoved:function(e){t.debug("field removed",this.$el),u=u.splice(u.indexOf(e),1)}});return h.initialize(),h}}),define("validator/equal",["validator/default","form/util"],function(e,t){return function(n,r,i,s){var o={equal:null},u=[],a=function(e,t){return u.indexOf(e)&&!!e.options.validationEqual&&e.options.validationEqual===t},f=function(e){var t=!0;return $.each(u,function(n,r){return l(e,r)?!0:(t=!1,!1)}),t},l=function(e,t){return e===t.getValue()},c=function(){$.each(u,function(e,t){t.update()})},h=$.extend(new e(n,r,o,s,"equal"),{initializeSub:function(){i.initialized.then(function(){$.each(r.elements,function(e,t){this.fieldAdded(t)}.bind(this))}.bind(this))},validate:function(){var e=this.$el.val(),t;if(!this.data.equal)throw"No option group set";return t=f(e),c(),t},update:function(){var e=t.getValue(this.$el),n;if(!this.data.equal)throw"No option group set";return n=f(e),n},fieldAdded:function(e){e.$el!==this.$el&&a(e,this.data.equal)&&u.push(e)},fieldRemoved:function(e){u=u.splice(u.indexOf(e),1)}});return h.initialize(),h}}),define("validator/regex",["validator/default","form/util"],function(e,t){return function(n,r,i,s){var o={regex:/\w*/},u=$.extend(new e(n,r,o,s,"regex"),{validate:function(){var e=this.data.regex,n=new RegExp(e),r=t.getValue(this.$el);return r===""?!0:n.test(r)}});return u.initialize(),u}});