var libFuncName=null;if("undefined"==typeof jQuery&&"undefined"==typeof Zepto&&"function"==typeof $)libFuncName=$;else if("function"==typeof jQuery)libFuncName=jQuery;else{if("function"!=typeof Zepto)throw new TypeError;libFuncName=Zepto}!function(a,b){"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||b,c.concat(Array.prototype.slice.call(arguments)))};return e.prototype=this.prototype,f.prototype=new e,f});var c={version:"0.1.0",Ui:{},Util:{},$:function(){return"undefined"!=typeof Zepto?Zepto:jQuery}()};c.DEBUG=!1;var d=/\s+/;c.Events={on:function(a,b,c){var e,f,g;if(!b)return this;for(a=a.split(d),e=this._callbacks||(this._callbacks={});f=a.shift();)g=e[f]||(e[f]=[]),g.push(b,c);return this},off:function(a,b,c){var e,f,g,h;if(!(f=this._callbacks))return this;if(!(a||b||c))return delete this._callbacks,this;for(a=a?a.split(d):_.keys(f);e=a.shift();)if((g=f[e])&&(b||c))for(h=g.length-2;h>=0;h-=2)b&&g[h]!==b||c&&g[h+1]!==c||g.splice(h,2);else delete f[e];return this},trigger:function(a){var b,c,e,f,g,h,i,j;if(!(c=this._callbacks))return this;for(j=[],a=a.split(d),f=1,g=arguments.length;g>f;f++)j[f-1]=arguments[f];for(;b=a.shift();){if((i=c.all)&&(i=i.slice()),(e=c[b])&&(e=e.slice()),e)for(f=0,g=e.length;g>f;f+=2)e[f].apply(e[f+1]||this,j);if(i)for(h=[b].concat(j),f=0,g=i.length;g>f;f+=2)i[f].apply(i[f+1]||this,h)}return this}},c.Collection={byId:{},objs:[],add:function(a){this.byId[a.id]=a,this.objs.push(a)},get:function(a){return this.byId[a.id||a]}},c.Model={get:function(a){return this[a]},set:function(a,b){return!!b&&(this[a]=b),this}},b.Husky=c}(libFuncName,this,this.document),function(a){"use strict";Husky.Ui.DataGrid=function(b,c){this.name="Husky.Ui.DataGrid",Husky.DEBUG&&console.log(this.name,"create instance"),this.options=c,this.$element=a(b),this.$list=null,this.options.columnMapping={tile:{display:"Title",width:"20%",sortable:!0},date:{display:"Last edit date",width:"20%",sortable:!1}},this.data=null,this.options.url&&this.loadData()},a.extend(Husky.Ui.DataGrid.prototype,Husky.Events,{loadData:function(a){Husky.DEBUG&&console.log(this.name,"loadData"),Husky.Util.ajax({url:a||this.options.url,success:function(a){this.data=a,this.prepareView(),this.render()}.bind(this)})},prepareView:function(){var b=null,c="",d="";"list"===this.options.listType?b=a("<ul/>"):(b=a("<table/>",{"class":this.options.className&&"table"!==this.options.className?"table "+this.options.className:"table"}),this.data.forEach(function(b){d="",a.each(b,function(a,b){d+="<td>"+b+"</td>"}),c+="<tr>"+d+"</tr>"}),b.append(c)),this.$list=b},render:function(){this.$element.html(this.$list)}}),a.fn.huskyList=function(b){return b=a.extend({},a.fn.huskyList.defaults,"object"==typeof b&&b),new Husky.Ui.DataGrid(this,b),this},a.fn.huskyList.defaults={listType:"table"}}(Husky.$,this,this.document),function(a){"use strict";var b="Husky.Ui.Navigation";Husky.Ui.Navigation=function(c,d){this.name=b,Husky.DEBUG&&console.log(this.name,"create instance"),this.options=d,this.configs={},this.$element=a(c),this.$navigation=a("<div/>",{"class":"navigation"}),this.currentColumnIdx=0,this.lastColumnIdx=0,this.data=null,this.columnHeader=null,this.columnItems=null,this.options.url&&this.load({url:this.options.url,success:function(){this.prepareNavigation(),this.render()}.bind(this)})},a.extend(Husky.Ui.Navigation.prototype,Husky.Events,{vent:function(){return a.extend({},Husky.Events)}(),load:function(a){Husky.DEBUG&&console.log(this.name,"load"),Husky.Util.ajax({url:a.url,success:function(b){Husky.DEBUG&&console.log(this.name,"load","success",b),this.data=b,this.columnHeader=this.data.header||null,this.columnItems=this.data.sub.items||null,"function"==typeof a.success&&a.success(this.data)}.bind(this)})},prepareNavigation:function(){return this.$navigationColumns=a("<ul/>",{"class":"navigation-columns"}),this.$navigationColumns.append(this.prepareNavigationColumn()),this.$navigation.append(this.$navigationColumns),this},prepareNavigationColumn:function(){var b;return b=a("<li/>",{id:"column-"+this.currentColumnIdx,"data-column-id":this.currentColumnIdx,"class":"navigation-column"}),b.append(this.prepareColumnItems()),b},prepareColumnItems:function(){var b,c,d,e,f,g,h,i,j,k;return c=[],b=a("<ul/>",{"class":"navigation-items"}),this.columnItems&&(this.itemsCollection&&delete this.itemsCollection,this.itemsCollection=new this.collections.items,this.columnItems.forEach(function(a){j=this.models.item(a),this.itemsCollection.add(j),e=[],!!a.class&&e.push(a.class),e.push("navigation-column-item"),d=' class="'+e.join(" ")+'"',g=a.hasSub?' data-has-sub="true"':"",i='title="'+a.title+'"',h=a.icon?'<span class="icon-'+a.icon+'"></span>':"",k='id="'+j.get("id")+'"',c.push("<li ",k,i,d,f,g,">",h,a.title,"</li>")}.bind(this)),b.append(c.join(""))),b},addColumn:function(){var a,b;if(this.currentColumnIdx++,this.currentColumnIdx<this.lastColumnIdx||this.currentColumnIdx===this.lastColumnIdx)for(b=this.currentColumnIdx;b<=this.lastColumnIdx;b++)a=this.$navigationColumns.find("#column-"+b),a.size()&&a.remove();this.$navigationColumns.append(this.prepareNavigationColumn())},selectItem:function(b){Husky.DEBUG&&console.log(this.name,"selectItem");var c,d,e,f,g;c=a(b.currentTarget),f=c.attr("id"),d=c.parent().parent(),e=a("#column-0"),g=this.itemsCollection.get(f),this.lastColumnIdx=this.currentColumnIdx,this.currentColumnIdx=d.data("column-id"),g&&(d.find(".selected").removeClass("selected"),c.addClass("selected"),this.trigger("navigation:item:selected",g),g.get("hasSub")?g.get("sub")?(this.columnItems=this.itemsCollection.get(c.attr("id")).get("sub").items,this.addColumn()):(this.addLoader(c),this.load({url:g.get("action"),success:function(){this.addColumn(),this.hideLoader(c),this.currentColumnIdx>0?e.addClass("collapsed"):e.removeClass("collapsed"),this.trigger("navigation:item:sub:loaded",g)}.bind(this)})):this.trigger("navigation:item:content:show",g))},bindDOMEvents:function(){this.$element.on("click",".navigation-column-item:not(.selected)",this.selectItem.bind(this))},render:function(){this.$element.html(this.$navigation),this.bindDOMEvents()},addLoader:function(a){a.addClass("loading")},hideLoader:function(a){a.removeClass("loading")},collections:{items:function(){return a.extend({},Husky.Collection)}},models:{item:function(b){var c={title:"",hasSub:!1};return a.extend({},Husky.Model,c,b)}},template:{search:function(a){return a=a||{},a.action=a.action||"",a.icon=a.icon||"",['<form action="',a.action,'">','<input type="text" class="search" autofill="false" placeholder="Search ..."/>',"</form>"].join()}}}),a.fn.huskyNavigation=function(c){var d=a(this);return c=a.extend({},a.fn.huskyNavigation.defaults,"object"==typeof c&&c),d.data(b)?this:(d.data(b,new Husky.Ui.Navigation(this,c)),this)},a.fn.huskyNavigation.defaults={url:"",collapse:!1}}(Husky.$,this,this.document),function(a){"use strict";Husky.Util={ajax:function(b){return b=a.extend({},b),a.ajax(b)}}}(Husky.$,this,this.document);