<!doctype html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="stylesheet" href="../../dist/husky.min.css">

    <style>
        #content {
            margin-left: 300px;
        }
    </style>

</head>
<body>

<div id="content">
    <a href="#" id="collapse">collapse navigation</a>
    <a href="#" id="force">force collapse navigation</a>
    <a href="#" id="show">show navigation</a>
    <a href="#" id="hide">hide navigation</a>
</div>

<div data-aura-component="navigation@husky" class="" data-aura-select-action="webspaces/cn_cn"
     data-aura-url="/navigation"
     data-aura-footer-template="<div>Hubert Gruber</div><div><a href='#'>logout</a></div><div class='version'>husky 2.1.2</div>"></div>

<script src="../js/sinon.js"></script>
<script src="../js/jquery.js"></script>

<script src="../js/require.js"></script>

<script>
    require.config({
        baseUrl: '../../'
    });

    require(['lib/husky'], function(Husky) {
        'use strict';

        var fakeServer = sinon.fakeServer.create(),
                app = Husky({ debug: { enable: true }}),
                _ = app.sandbox.util._;

        fakeServer.respondWith('GET', '/navigation', [200, { 'Content-Type': 'application/json' },
            '{"title":"Sulu 2.0", "icon":"..\/..\/img\/tmp\/husky.png", "id":"1", "items":[' +

                    '{"title":"Tools", "items":[' +
                    '{"title":"Dashboard", "action":"dashboard", "icon":"dashboard", "id":"2", "hasSettings":"true"},' +

                    '{"title":"Contacts", "hasSettings":"true", "icon":"contact-book", "id":"3", "items":[' +
                    '{"title":"Companies", "action":"contacts\/accounts", "id":"4"},' +
                    '{"title":"People", "action":"contacts\/contacts", "id":"5"}' +
                    ']},' +

                    '{"title":"Media", "icon":"star", "hasSettings":"true", "id":"6", "items":[' +
                    '{"title":"Images", "id":"7", "action":"media\/images"},' +
                    '{"title":"Documents", "id":"8", "action":"media\/documents"},' +
                    '{"title":"Movies", "id":"9", "action":"media\/movies"}' +
                    ']},' +

                    '{"title":"Messages", "icon":"settings", "id":"10"},' +

                    '{"title":"Settings", "icon":"settings", "id":"11", "items":[' +
                    '{"title":"Roles &amp; Permissions", "action":"settings\/roles", "type":"content", "id":"12"},' +
                    '{"title":"Translate", "action":"settings\/translate", "id":"13"}' +
                    ']}' +
                    ']},' +

                    '{"title":"Web-Spaces", "items":[' +
                    '{"title":"Americas", "icon":"globe", "hasSettings":"true", "id":"14", "items":[' +
                    '{"title":"en_us", "action":"webspaces\/en_us", "id":"15"},' +
                    '{"title":"en_cn", "action":"webspaces\/en_cn", "id":"16"},' +
                    '{"title":"es_mx", "action":"webspaces\/es_mx", "id":"17"}' +
                    ']},' +
                    '{"title":"Europe", "icon":"globe", "hasSettings":"true", "id":"18", "items":[' +
                    '{"title":"en_gb", "action":"webspaces\/en_gb", "id":"19"},' +
                    '{"title":"de_de", "action":"webspaces\/de_de", "id":"20"},' +
                    '{"title":"de_at", "action":"webspaces\/de_at", "id":"21"}' +
                    ']},' +
                    '{"title":"Asia", "icon":"globe", "id":"22", "items":[' +
                    '{"title":"cn_cn", "action":"webspaces\/cn_cn", "id":"23"},' +
                    '{"title":"jp_jp", "action":"webspaces\/jp_jp", "id":"24"}' +
                    ']}' +
                    ']}' +
                    ']}'
        ]);

        app.start().then(function() {
            app.logger.log('Aura started...');

            var collapse = function(force, event) {
                if (!!event) {
                    event.preventDefault();
                }
                var namespace = 'husky.navigation.',
                        postfix = !this.collapsed ? 'collapse' : 'uncollapse',
                        label = this.collapsed ? 'collapse' : 'uncollapse',
                        eventName = namespace + postfix;
                this.collapsed = !this.collapsed;
                app.sandbox.dom.html('#collapse', label + ' navigation');
                app.sandbox.emit(eventName, force ? true : false);
            }.bind(this);

            app.sandbox.on('husky.util.load.data', function() {
                setTimeout(function() {
                    fakeServer.respond();
                }, 500);
            });


            app.sandbox.on('husky.navigation.collapsed', function() {
                this.collapsed = true;
            }, this);
            app.sandbox.on('husky.navigation.uncollapsed', function() {
                this.collapsed = false;
            }, this);

            app.sandbox.dom.on('#collapse', 'click', collapse.bind(this, false));
            app.sandbox.dom.on('#force', 'click', collapse.bind(this, true));

            app.sandbox.dom.on('#show', 'click', function(){
                app.sandbox.emit('husky.navigation.show');
            }.bind(this));

            app.sandbox.dom.on('#hide', 'click', function(){
                app.sandbox.emit('husky.navigation.hide');
            }.bind(this));



        });
    });

</script>

</body>
</html>
