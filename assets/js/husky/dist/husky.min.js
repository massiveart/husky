function typeOf(a){var b=typeof a;return"object"===b&&(a?a instanceof Array&&(b="array"):b="null"),b}var libFuncName=null;if("undefined"==typeof jQuery&&"undefined"==typeof Zepto&&"function"==typeof $)libFuncName=$;else if("function"==typeof jQuery)libFuncName=jQuery;else{if("function"!=typeof Zepto)throw new TypeError;libFuncName=Zepto}!function(a,b){"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)}),Array.prototype.inArray||(Array.prototype.inArray=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return!0;return!1}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||b,c.concat(Array.prototype.slice.call(arguments)))};return e.prototype=this.prototype,f.prototype=new e,f});var c={version:"0.1.0",Ui:{},Util:{},$:function(){return"undefined"!=typeof Zepto?Zepto:jQuery}()};c.DEBUG=!1;var d=/\s+/;c.Events={on:function(a,b,c){var e,f,g;if(!b)return this;for(a=a.split(d),e=this._callbacks||(this._callbacks={});f=a.shift();)g=e[f]||(e[f]=[]),g.push(b,c);return this},off:function(a,b,c){var e,f,g,h;if(!(f=this._callbacks))return this;if(!(a||b||c))return delete this._callbacks,this;for(a=a?a.split(d):_.keys(f);e=a.shift();)if((g=f[e])&&(b||c))for(h=g.length-2;h>=0;h-=2)b&&g[h]!==b||c&&g[h+1]!==c||g.splice(h,2);else delete f[e];return this},trigger:function(a){var b,c,e,f,g,h,i,j;if(!(c=this._callbacks))return this;for(j=[],a=a.split(d),f=1,g=arguments.length;g>f;f++)j[f-1]=arguments[f];for(;b=a.shift();){if((i=c.all)&&(i=i.slice()),(e=c[b])&&(e=e.slice()),e)for(f=0,g=e.length;g>f;f+=2)e[f].apply(e[f+1]||this,j);if(i)for(h=[b].concat(j),f=0,g=i.length;g>f;f+=2)i[f].apply(i[f+1]||this,h)}return this}},c.Collection={byId:{},objs:[],add:function(a){this.byId[a.id]=a,this.objs.push(a)},get:function(a){return this.byId[a.id||a]}},c.Model={get:function(a){return this[a]},set:function(a,b){return!!b&&(this[a]=b),this}},b.Husky=c}(libFuncName,this,this.document),function(a){"use strict";var b="Husky.Ui.AutoComplete",c=[],d="husky-auto-complete-success",e="husky-auto-complete-fail",f="husky-auto-complete-loading";Husky.Ui.AutoComplete=function(c,d){this.name=b,Husky.DEBUG&&console.log(this.name,"create instance"),this.options=d,this.configs={},this.$originalElement=a(c),this.$element=a('<div class="husky-auto-complete dropdown"/>'),a(c).append(this.$element),this.init()},a.extend(Husky.Ui.AutoComplete.prototype,Husky.Events,{vent:function(){return a.extend({},Husky.Events)}(),getUrl:function(a){var b="?";return-1!=this.options.url.indexOf("?")&&(b="&"),this.options.url+b+"search="+a},getValueID:function(){return null!=this.options.value?this.options.value.id:null},getValueName:function(){return null!=this.options.value?this.options.value[this.options.valueName]:""},init:function(){Husky.DEBUG&&console.log(this.name,"init"),this.$valueField=a('<input type="text" autofill="false" class="name-value form-element" data-id="'+this.getValueID()+'" value="'+this.getValueName()+'"/>'),this.$dropDown=a('<div class="dropdown-menu" />'),this.$dropDownList=a("<ul/>"),this.$element.append(this.$valueField),this.$element.append(this.$dropDown),this.$dropDown.append(this.$dropDownList),this.hideDropDown(),this.bindDOMEvents(),null!=this.options.value&&this.successState()},bindDOMEvents:function(){this.$element.off(),this.$valueField.on("input",this.inputChanged.bind(this)),this.$dropDownList.on("click","li",function(b){var c=a(b.currentTarget),d=c.data("id"),e={id:d};e[this.options.valueName]=c.text(),this.selectItem(e)}.bind(this)),this.$valueField.on("focusin",function(){this.$valueField.trigger("input")}.bind(this)),this.$valueField.on("focusout",function(){setTimeout(function(){this.hideDropDown()}.bind(this),250)}.bind(this)),this.options.keyControl&&(this.$valueField.on("keydown",function(a){-1!=[40,38,13].indexOf(a.which)&&(a.preventDefault(),this.$dropDown.is(":visible")?40==a.which?this.pressKeyDown():38==a.which?this.pressKeyUp():13==a.which&&this.pressKeyEnter():(this.noState(),this.loadData(this.$valueField.val())))}.bind(this)),this.$dropDownList.on("mouseover","li",function(){this.$dropDownList.children().removeClass("hover")}.bind(this)))},inputChanged:function(){Husky.DEBUG&&console.log(this.name,"inputChanged"),this.noState();var a=this.$valueField.val();a.length>=this.options.minLength&&this.loadData(a)},loadData:function(a){var b=this.getUrl(a);Husky.DEBUG&&console.log(this.name,"load: "+b),this.loadingState(),Husky.Util.ajax({url:b,success:function(a){Husky.DEBUG&&console.log(this.name,"load","success"),this.noState(),this.updateData(a.items),c.length>1?this.generateDropDown(c):1==c.length?this.selectItem(c[0]):(this.failState(),this.hideDropDown())}.bind(this),error:function(){Husky.DEBUG&&console.log(this.name,"load","error"),this.failState(),this.hideDropDown()}.bind(this)}),this.trigger("auto-complete:loadData",null)},updateData:function(a){c=[],a.forEach(function(a){this.isVisible(a)&&c.push(a)}.bind(this))},generateDropDown:function(a){this.clearDropDown(),a.forEach(function(a){this.isVisible(a)&&this.$dropDownList.append('<li data-id="'+a.id+'">'+a[this.options.valueName]+"</li>")}.bind(this)),this.showDropDown()},isVisible:function(a){var b=!0;return this.options.excludeItems.forEach(function(c){parseInt(a.id)===parseInt(c.id)&&(b=!1)}.bind(this)),b},clearDropDown:function(){this.$dropDown.children("ul").children("li").remove()},showDropDown:function(){Husky.DEBUG&&console.log(this.name,"show dropdown"),this.$dropDown.show()},hideDropDown:function(){Husky.DEBUG&&console.log(this.name,"hide dropdown"),this.clearDropDown(),this.$dropDown.hide()},successState:function(){Husky.DEBUG&&console.log(this.name,"set success"),this.clearDropDown(),this.$originalElement.removeClass(e),this.$originalElement.removeClass(f),this.$originalElement.addClass(d)},noState:function(){Husky.DEBUG&&console.log(this.name,"remove success and fail"),this.$valueField.data(""),this.$originalElement.removeClass(e),this.$originalElement.removeClass(f),this.$originalElement.removeClass(d)},failState:function(){Husky.DEBUG&&console.log(this.name,"set fail"),this.$originalElement.addClass(e),this.$originalElement.removeClass(f),this.$originalElement.removeClass(d)},loadingState:function(){Husky.DEBUG&&console.log(this.name,"set loading"),this.$originalElement.removeClass(e),this.$originalElement.addClass(f),this.$originalElement.removeClass(d)},pressKeyDown:function(){Husky.DEBUG&&console.log(this.name,"key down");var a=this.$dropDownList.children(".hover"),b=a.next();0==b.length&&(b=this.$dropDownList.children().first()),a.removeClass("hover"),b.addClass("hover")},pressKeyUp:function(){Husky.DEBUG&&console.log(this.name,"key up");var a=this.$dropDownList.children(".hover"),b=a.prev();0==b.length&&(b=this.$dropDownList.children().last()),a.removeClass("hover"),b.addClass("hover")},pressKeyEnter:function(){Husky.DEBUG&&console.log(this.name,"key enter");var b=this.$dropDownList.children(".hover");if(1==b.length){var c={id:b.data("id")};c[this.options.valueName]=b.text(),this.selectItem(c)}else{var d=this.$valueField.val(),e=this.$dropDownList.children(),f=this;a(e).each(function(){if(a(this).text()==d){var b={id:a(this).data("id")};return b[f.options.valueName]=a(this).text(),f.selectItem(b),!1}})}},selectItem:function(a){Husky.DEBUG&&console.log(this.name,"select item: "+a.id),this.$valueField.data("id",a.id),this.$valueField.val(a[this.options.valueName]),this.hideDropDown(),this.successState()}}),a.fn.huskyAutoComplete=function(c){var d=a(this);return c=a.extend({},a.fn.huskyAutoComplete.defaults,"object"==typeof c&&c),d.data(b)?this:(d.data(b,new Husky.Ui.AutoComplete(this,c)),this)},a.fn.huskyAutoComplete.defaults={url:"",valueName:"name",minLength:3,keyControl:!0,value:null,excludeItems:[]}}(Husky.$,this,this.document),function(a,b,c,d){"use strict";var e="Husky.Ui.DataGrid";Husky.Ui.DataGrid=function(b,c){this.name=e,Husky.DEBUG&&console.log(this.name,"create instance"),this.options=c,this.configs={},this.$originalElement=a(b),this.$element=a('<div class="husky-data-grid"/>'),a(b).append(this.$element),this.allItemIds=[],this.selectedItemIds=[],this.data=null,this.options.pagination=this.options.pagination!==d?!!this.options.pagination:!!this.options.url,this.options.url?this.load({url:this.options.url}):this.options.data.items&&(this.data=this.options.data,Husky.DEBUG&&console.log(this.data,"this.data set"),this.setConfigs(),this.prepare().appendPagination().render(),Husky.DEBUG&&console.log("data.items found"))},a.extend(Husky.Ui.DataGrid.prototype,Husky.Events,{vent:function(){return a.extend({},Husky.Events)}(),getUrl:function(a){var b="?";-1!=a.url.indexOf("?")&&(b="&");var c=a.url+b+"pageSize="+this.options.paginationOptions.pageSize;return a.page>1&&(c+="&page="+a.page),c},load:function(a){Husky.DEBUG&&console.log(this.name,"load"),Husky.Util.ajax({url:this.getUrl(a),data:a.data,success:function(b){Husky.DEBUG&&console.log(this.name,"load","success"),this.data=b,this.setConfigs(),this.prepare().appendPagination().render(),"function"==typeof a.success&&a.success(b)}.bind(this)})},setConfigs:function(){this.configs={},this.configs.total=this.data.total,this.configs.pageSize=this.data.pageSize,this.configs.page=this.data.page},prepare:function(){return this.$element.empty(),"list"===this.options.elementType||this.$element.append(this.prepareTable()),this},prepareTable:function(){var b,c,d,e;return b=a("<table/>"),(this.data.head||this.options.tableHead)&&(c=a("<thead/>"),c.append(this.prepareTableHead()),b.append(c)),this.data.items&&(d=a("<tbody/>"),d.append(this.prepareTableRows()),b.append(d)),e=[],e.push(this.options.className&&"table"!==this.options.className?"table "+this.options.className:"table"),e.push(this.options.selectItemType&&"checkbox"===this.options.selectItemType?"is-selectable":""),b.addClass(e.join(" ")),b},prepareTableHead:function(){var a,b,c,d;return a=[],d=this.options.tableHead||this.data.head,this.options.selectItemType&&"checkbox"===this.options.selectItemType&&a.push('<th class="select-all">',this.templates.checkbox({id:"select-all"}),"</th>"),d.forEach(function(d){b=d.class?' class="'+d.class+'"':"",c=d.width?' width="'+d.width+'px"':"",a.push("<th"+b+c+">"+d.content+"</th>")}),"<tr>"+a.join("")+"</tr>"},prepareTableRows:function(){var a;return a=[],this.allItemIds=[],this.data.items.forEach(function(b){a.push(this.prepareTableRow(b))}.bind(this)),a.join("")},prepareTableRow:function(a){if(this.options.template&&this.options.template.row)return _.template(this.options.template.row,a);var b,c,d,e,f;e=[],b="",!!a.id&&this.allItemIds.push(~~a.id),this.options.selectItemType&&"checkbox"===this.options.selectItemType?e.push("<td>",this.templates.checkbox(),"</td>"):this.options.selectItemType&&"radio"===this.options.selectItemType&&e.push("<td>",this.templates.radio({name:"husky-radio"}),"</td>");for(var g in a){var h=a[g];this.options.excludeFields.inArray(g)?b+=" data-"+g+'="'+h+'"':(f=[],c=h.thumb?'<img alt="'+(h.alt||"")+'" src="'+h.thumb+'"/>':h,!!h.class&&f.push(h.class),!!h.thumb&&f.push("thumb"),d=f.length?'class="'+f.join(" ")+'"':"",e.push("<td "+d+" >"+c+"</td>"))}return this.options.removeRow&&e.push('<td class="remove-row">',this.templates.removeRow(),"</td>"),"<tr"+b+">"+e.join("")+"</tr>"},resetItemSelection:function(){this.allItemIds=[],this.selectedItemIds=[]},selectItem:function(b){Husky.DEBUG&&console.log(this.name,"selectItem");var c,d;return c=a(b.currentTarget),c.is("input")||(c=c.parent().find("input")),d=c.parents("tr").data("id"),this.selectedItemIds.indexOf(d)>-1?(c.removeClass("is-selected").prop("checked",!1),a("th.select-all").find('input[type="checkbox"]').prop("checked",!1),this.selectedItemIds.splice(this.selectedItemIds.indexOf(d),1),this.trigger("data-grid:item:deselect",d)):(c.addClass("is-selected").prop("checked",!0),this.selectedItemIds.push(d),this.trigger("data-grid:item:select",d)),!1},selectAllItems:function(a){Husky.DEBUG&&console.log(this.name,"selectAllItems"),a.stopPropagation(),Husky.Util.compare(this.selectedItemIds,this.allItemIds)?(this.$element.find('input[type="checkbox"]').prop("checked",!1),this.selectedItemIds=[],this.trigger("data-grid:all:deselect",null)):(this.$element.find('input[type="checkbox"]').prop("checked",!0),this.selectedItemIds=this.allItemIds.slice(0),this.trigger("data-grid:all:select",this.selectedItemIds))},addRow:function(a){Husky.DEBUG&&console.log(this.name,"addRow");var b;b=this.$element.find("table"),b.append(this.prepareTableRow(a))},prepareRemoveRow:function(b){if(this.options.autoRemoveHandling)this.removeRow(b);else{var c,d;c=a(b.currentTarget),d=c.parent().parent(),this.trigger("data-grid:row:remove-click",b,d.data("id"))}},removeRow:function(b){Husky.DEBUG&&console.log(this.name,"removeRow");var c,d,e;"object"==typeof b?(c=a(b.currentTarget),d=c.parent().parent(),e=d.data("id")):(e=b,d=this.$element.find('tr[data-id="'+e+'"]')),this.trigger("data-grid:row:removed",b),d.remove()},appendPagination:function(){return this.options.pagination&&this.$element.append(this.preparePagination()),this},preparePagination:function(){var b;return this.configs.total&&~~this.configs.total>=1&&(b=a("<div/>"),b.addClass("pagination"),b.append(this.preparePaginationPrevNavigation()),b.append(this.preparePaginationPageNavigation()),b.append(this.preparePaginationNextNavigation())),b},preparePaginationPageNavigation:function(){return this.templates.paginationPageNavigation({pageSize:this.options.paginationOptions.pageSize,selectedPage:this.configs.page})},preparePaginationNextNavigation:function(){return this.templates.paginationNextNavigation({next:this.options.pagination.next,selectedPage:this.configs.page,pageSize:this.configs.total})},preparePaginationPrevNavigation:function(){return this.templates.paginationPrevNavigation({prev:this.options.pagination.prev,selectedPage:this.configs.page})},changePage:function(b){Husky.DEBUG&&console.log(this.name,"changePage");var c,d;c=a(b.currentTarget),d=c.data("page"),this.addLoader(),this.load({url:this.options.url,page:d,success:function(){this.removeLoader()}.bind(this)}),this.trigger("data-grid:page:change",null),this.vent.trigger("data-grid:update",null)},changePageSize:function(){},bindDOMEvents:function(){this.$element.off(),this.options.selectItemType&&"checkbox"===this.options.selectItemType?(this.$element.on("click","tbody > tr span.custom-checkbox-icon",this.selectItem.bind(this)),this.$element.on("change",'tbody > tr input[type="checkbox"]',this.selectItem.bind(this)),this.$element.on("click","th.select-all",this.selectAllItems.bind(this))):this.options.selectItemType&&"radio"===this.options.selectItemType&&this.$element.on("click",'tbody > tr input[type="radio"]',this.selectItem.bind(this)),this.$element.on("click","tbody > tr",function(b){a(b.target).is("input")||a(b.target).is("span.icon-remove")||this.trigger("data-grid:item:click",a(b.currentTarget).data("id"))}.bind(this)),this.options.pagination&&this.$element.on("click",".pagination li.page",this.changePage.bind(this)),this.options.removeRow&&this.$element.on("click",".remove-row > span",this.prepareRemoveRow.bind(this))},bindCustomEvents:function(){this.vent.off(),this.vent.on("data-grid:update",this.updateHandler.bind(this)),this.on("data-grid:row:add",this.addRow.bind(this)),this.on("data-grid:row:remove",this.removeRow.bind(this))},updateHandler:function(){this.resetItemSelection()},render:function(){this.$originalElement.html(this.$element),this.bindCustomEvents(),this.bindDOMEvents()},addLoader:function(){return this.$element.outerWidth(this.$element.outerWidth()).outerHeight(this.$element.outerHeight()).empty().addClass("is-loading")},removeLoader:function(){return this.$element.removeClass("is-loading")},templates:{removeRow:function(){return['<span class="icon-remove"></span>'].join("")},checkbox:function(a){var b,c;return a=a||{},b=a.id?' id="'+a.id+'"':"",c=a.name?' name="'+a.name+'"':"",["<input",b,c,' type="checkbox" class="custom-checkbox"/>','<span class="custom-checkbox-icon"></span>'].join("")},radio:function(a){var b,c;return a=a||{},b=a.id?' id="'+a.id+'"':"",c=a.name?' name="'+a.name+'"':"",["<input",b,c,' type="radio" class="custom-radio"/>','<span class="custom-radio-icon"></span>'].join("")},paginationPrevNavigation:function(a){var b;return a=a||{},b=~~a.selectedPage,["<ul>",'<li class="pagination-first page" data-page="1"></li>','<li class="pagination-prev page" data-page="',b-1,'">',"Previous","</li>","</ul>"].join("")},paginationNextNavigation:function(a){var b,c,d,e;return a=a||{},b=a.next||"Next",c=a.last||"Last",d=a.pageSize,e=~~a.selectedPage,["<ul>",'<li class="pagination-next page" data-page="',e+1,'">',b,"</li>",'<li class="pagination-last page" data-page="',d,'"></li>',"</ul>"].join("")},paginationPageNavigation:function(a){var b,c,d,e,f;for(a=a||{},b=~~a.pageSize,e=~~a.selectedPage,d=[],c=1;b>=c;c++)f=e===c?'class="page is-selected"':'class="page"',d.push("<li ",f,' data-page="',c,'">',c,"</li>");return d.push('<li class="is-disabled">...</li>'),"<ul>"+d.join("")+"</ul>"}}}),a.fn.huskyDataGrid=function(b){var c=a(this);return b=a.extend({},a.fn.huskyDataGrid.defaults,"object"==typeof b&&b),c.data(e)?this:(c.data(e,new Husky.Ui.DataGrid(this,b)),this)},a.fn.huskyDataGrid.defaults={elementType:"table",selectItemType:null,pagination:!1,paginationOptions:{pageSize:10,showPages:5},excludeFields:["id"],autoRemoveHandling:!0}}(Husky.$,this,this.document),function(a){"use strict";var b,c="Husky.Ui.Dialog";Husky.Ui.Dialog=function(b,d){this.name=c,this.options=d,this.configs={},this.$element=a('<div class="husky-dialog hidden fade"/>'),a(b).append(this.$element),this.init()},a.extend(Husky.Ui.Dialog.prototype,Husky.Events,{vent:function(){return a.extend({},Husky.Events)}(),init:function(){Husky.DEBUG&&console.log(this.name,"init"),this.prepare(),this.bindDOMEvents(),this.bindCustomEvents()},prepare:function(){this.$header=a('<div class="husky-dialog-header align-right"/>'),this.$content=a('<div class="husky-dialog-body" />'),this.$footer=a('<div class="husky-dialog-footer" />'),this.$element.append(this.$header),this.$element.append(this.$content),this.$element.append(this.$footer);var b=this.options.width,c=parseInt(this.options.width)/2;this.$element.css({width:b,"margin-left":"-"+c+"px"})},bindDOMEvents:function(){this.$element.off(),this.$element.on("click",".close",this.hide.bind(this))},bindCustomEvents:function(){this.vent.off(),this.on("dialog:show",this.show.bind(this)),this.on("dialog:hide",this.hide.bind(this))},show:function(c){var d=a.extend({},a.fn.huskyDialog.defaults,"object"==typeof c&&c);this.template=d.template,this.data=d.data,this.$header.append(_.template(this.template.header,this.data.header)),this.$content.append(_.template(this.template.content,this.data.content)),this.$footer.append(_.template(this.template.footer,this.data.footer)),this.$element.show(),this.options.backdrop&&(b=a('<div id="husky-dialog-backdrop" class="husky-dialog-backdrop fade in"></div>'),a("body").append(b),b.click(function(){this.hide()}.bind(this)))},hide:function(){this.$element.hide(),this.options.backdrop&&a("#husky-dialog-backdrop ").remove(),this.template=null,this.data=null,this.$header.empty(),this.$content.empty(),this.$footer.empty()}}),a.fn.huskyDialog=function(b){var d=a(this);return b=a.extend({},a.fn.huskyDialog.defaults,"object"==typeof b&&b),d.data(c)?this:(d.data(c,new Husky.Ui.Dialog(this,b)),this)},a.fn.huskyDialog.defaults={data:null,backdrop:!0,width:"560px",template:{content:"<h3><%= title %></h3><p><%= content %></p>",footer:'<button class="btn btn-black closeButton"><%= buttonCancelText %></button><button class="btn btn-black saveButton"><%= buttonSaveText %></button>',header:'<button type="button" class="close">×</button>'}}}(Husky.$,this,this.document),function(a){"use strict";var b="Husky.Ui.DropDown";Husky.Ui.DropDown=function(c,d){this.name=b,Husky.DEBUG&&console.log(this.name,"create instance"),this.options=d,this.configs={},this.$originalElement=a(c),this.$element=a('<div class="husky-drop-down"/>'),a(c).append(this.$element),this.init()},a.extend(Husky.Ui.DropDown.prototype,Husky.Events,{vent:function(){return a.extend({},Husky.Events)}(),getUrl:function(){return this.options.url},init:function(){Husky.DEBUG&&console.log(this.name,"init"),this.$dropDown=a('<div class="dropdown-menu" />'),this.$dropDownList=a("<ul/>"),this.$element.append(this.$dropDown),this.$dropDown.append(this.$dropDownList),this.hideDropDown(),this.options.setParentDropDown&&this.$element.parent().addClass("dropdown"),this.bindDOMEvents(),this.prepareData()},bindDOMEvents:function(){this.$element.off(),""!=this.options.trigger?this.$originalElement.on("click",this.options.trigger,this.triggerClick.bind(this)):this.$originalElement.on("click",this.triggerClick.bind(this)),this.$dropDownList.on("click","li",function(b){var c=a(b.currentTarget),d=c.data("id");this.clickItem(d)}.bind(this))},clickItem:function(a){this.options.data.forEach(function(b){return b.id==a?(Husky.DEBUG&&console.log(this.name,"click-item: "+a,"success"),this.trigger("drop-down:click-item",b),!1):void 0}.bind(this)),this.hideDropDown()},triggerClick:function(){this.toggleDropDown()},prepareData:function(){this.options.data.length>0?this.generateDropDown(this.options.data):this.loadData()},loadData:function(){var a=this.getUrl();Husky.DEBUG&&console.log(this.name,"load: "+a),Husky.Util.ajax({url:a,success:function(a){Husky.DEBUG&&console.log(this.name,"load","success"),this.options.data=a.total>0&&a.items.length==a.total?a.items:[],this.generateDropDown(this.options.data)}.bind(this),error:function(){Husky.DEBUG&&console.log(this.name,"load","error"),this.options.data=[],this.generateDropDown(this.options.data)}.bind(this)}),setTimeout(function(){this.trigger("drop-down:loadData",null)}.bind(this),200)},generateDropDown:function(a){this.clearDropDown(),a.length>0?a.forEach(function(a){this.isVisible(a)&&this.$dropDownList.append('<li data-id="'+a.id+'">'+a[this.options.valueName]+"</li>")}.bind(this)):this.$dropDownList.append("<li>No data received</li>")},isVisible:function(a){var b=!0;return this.options.excludeItems.forEach(function(c){a.id==c.id&&(b=!1)}.bind(this)),b},clearDropDown:function(){this.$dropDown.children("ul").children("li").remove()},toggleDropDown:function(){Husky.DEBUG&&console.log(this.name,"toggle dropdown"),this.$dropDown.toggle()},showDropDown:function(){Husky.DEBUG&&console.log(this.name,"show dropdown"),this.$dropDown.show()},hideDropDown:function(){Husky.DEBUG&&console.log(this.name,"hide dropdown"),this.$dropDown.hide()}}),a.fn.huskyDropDown=function(c){var d=a(this);return c=a.extend({},a.fn.huskyDropDown.defaults,"object"==typeof c&&c),d.data(b)?this:(d.data(b,new Husky.Ui.DropDown(this,c)),this)},a.fn.huskyDropDown.defaults={url:"",data:[],trigger:"",valueName:"name",setParentDropDown:!1,excludeItems:[]}}(Husky.$,this,this.document),function(a,b){"use strict";var c="Husky.Ui.Navigation";Husky.Ui.Navigation=function(b,d){this.name=c,Husky.DEBUG&&console.log(this.name,"create instance"),this.options=d,this.configs={},this.$element=a(b),this.$navigation=a("<div/>",{"class":"navigation"}),this.currentColumnIdx=0,this.data=null,this.columnHeader=null,this.columnItems=null,this.options.url&&this.load({url:this.options.url,success:function(){this.prepareNavigation(),this.render()}.bind(this)})},a.extend(Husky.Ui.Navigation.prototype,Husky.Events,{vent:function(){return a.extend({},Husky.Events)}(),load:function(a){Husky.DEBUG&&console.log(this.name,"load"),Husky.Util.ajax({url:a.url,success:function(b){Husky.DEBUG&&console.log(this.name,"load","success",b),this.data=b,this.columnHeader=this.data.header||null,this.columnItems=this.data.sub.items||null,this.setConfigs(b),"function"==typeof a.success&&a.success(this.data)}.bind(this)})},setConfigs:function(a){this.configs={displayOption:a.displayOption||null}},prepareNavigation:function(){return this.$navigationColumns=a("<ul/>",{"class":"navigation-columns"}),this.$navigationColumns.append(this.prepareNavigationColumn()),this.$navigation.append(this.$navigationColumns),this},setNavigationSize:function(){var c=a(b),d=a(".navigation-sub-columns-container"),e=a(".navigation-sub-columns"),f=100;setTimeout(function(){e.css({width:"auto"}),d.removeClass("scrolling"),c.width()<this.$navigation.width()+f?(e.css({width:c.width()-f-(this.$navigation.width()-e.width()),height:this.$navigation.height()}),d.addClass("scrolling")):e.css({height:this.$navigation.height()+5})}.bind(this),250)},prepareNavigationColumn:function(){var b,c;return c=[" "],this.$navigationColumns.removeClass("show-content"),"content"===this.configs.displayOption?(c.push("content-column"),this.$navigationColumns.addClass("show-content")):1===this.currentColumnIdx&&c.push("second-column"),b=a("<li/>",{id:"column-"+this.currentColumnIdx,"data-column-id":this.currentColumnIdx,"class":"navigation-column"+(c.length>1?c.join(" "):"")}),this.columnHeader&&b.append(this.prepareColumnHeader()),b.append(this.prepareColumnItems()),b},prepareNavigationSubColumn:function(){return this.$navigationSubColumns=a("<ul/>",{"class":"navigation-sub-columns"}),this.$navigationSubColumns},prepareColumnHeader:function(){var b;return b=a("<div/>",{"class":"navigation-column-header"}),b.html(this.template.columnHeader({title:this.columnHeader.title,logo:this.columnHeader.logo})),b},prepareColumnItems:function(){var b,c,d,e,f,g,h,i,j,k;return c=[],b=a("<ul/>",{"class":"navigation-items"}),this.columnItems&&(this.itemsCollection&&delete this.itemsCollection,this.itemsCollection=new this.collections.items,this.columnItems.forEach(function(a){j=this.models.item(a),this.itemsCollection.add(j),e=[],!!j.get("class")&&e.push(j.get("class")),e.push("navigation-column-item"),d=' class="'+e.join(" ")+'"',g=j.get("hasSub")?' data-has-sub="true"':"",i='title="'+j.get("title")+'"',h=j.get("icon")?'<span class="icon-'+j.get("icon")+'"></span>':"",k='id="'+j.get("id")+'"',c.push("<li ",k,i,d,f,g,">",h,j.get("title"),"</li>")}.bind(this)),b.append(c.join(""))),b},addColumn:function(){var b;this.currentColumnIdx++,2!==this.currentColumnIdx||a(".navigation-sub-columns-container").size()||(b=a("<li/>",{"class":"navigation-sub-columns-container"}),b.append(this.prepareNavigationSubColumn()),this.$navigationColumns.append(b)),a(".navigation-sub-columns-container").size()?(this.$navigationSubColumns.append(this.prepareNavigationColumn()),this.scrollToLastSubColumn()):this.$navigationColumns.append(this.prepareNavigationColumn()),this.setNavigationSize()},collapseFirstColumn:function(){Husky.DEBUG&&console.log(this.name,"collapseFirstColumn");var b;b=a("#column-0"),b.addClass("collapsed")},showNavigationColumns:function(b){var c,d,e;e=a(b.target),c=a("#column-0"),d=a("#column-1"),this.$navigationColumns.removeClass("show-content"),this.showContent=!1,e.hasClass("navigation-column-item")||e.is("span")?(c.removeClass("hide"),d.removeClass("collapsed")):(c.removeClass("hide"),d.removeClass("collapsed"),this.hideColumn()),this.setNavigationSize()},selectionLocked:!0,showContent:!1,selectItem:function(b){Husky.DEBUG&&console.log(this.name,"selectItem");var c,d,e,f;this.showContent=!1,c=a(b.currentTarget),d=c.parent().parent(),e=c.attr("id"),f=this.itemsCollection.get(e),this.currentColumnIdx=d.data("column-id"),this.currentColumnIdx=d.data("column-id"),f&&this.selectionLocked&&(d.find(".selected").removeClass("selected"),c.addClass("selected"),this.trigger("navigation:item:selected",{item:f,data:this.getNavigationData()}),f.get("hasSub")?f.get("sub")?(this.setConfigs({}),this.columnHeader=f.get("header")||null,this.columnItems=f.get("sub").items,this.updateColumns(),this.addColumn(),this.currentColumnIdx>1&&this.collapseFirstColumn(),this.trigger("navigation:item:sub:show",{item:f,data:this.getNavigationData()})):(this.selectionLocked=!1,this.addLoader(c),this.updateColumns(),this.load({url:f.get("action"),success:function(){this.selectionLocked=!0,this.addColumn(),this.hideLoader(c),this.currentColumnIdx>1&&this.collapseFirstColumn(),this.trigger("navigation:item:sub:loaded",{item:f,data:this.getNavigationData()})}.bind(this)})):"content"==f.get("type")&&(this.showContent=!0,this.updateColumns(),this.collapseFirstColumn(),this.trigger("navigation:item:content:show",{item:f,data:this.getNavigationData()})))},updateColumns:function(){a(".navigation-columns > li:gt("+this.currentColumnIdx+")").remove(),a(".navigation-column:gt("+this.currentColumnIdx+")").remove()},getNavigationWidth:function(){var b=a(".navigation-column"),c=0,d=null;return a.each(b,function(b,e){d=a(e),c+=d.hasClass("collapsed")?50:250}.bind(this)),c},getNavigationData:function(){return{navWidth:this.getNavigationWidth()}},showFirstNavigationColumn:function(b){Husky.DEBUG&&console.log(this.name,"showFirstNavigationColumn");var c=a(b.target);a("#column-0").removeClass("hide").removeClass("collapsed"),c.hasClass("navigation-column-item")||c.is("span")||(this.currentColumnIdx=1,this.updateColumns(),a("#column-1").find(".selected").removeClass("selected"))},showColumn:function(b){Husky.DEBUG&&console.log(this.name,"showColumn");var c;b=b||{},b.data?(this.columnHeader=b.data.header||null,this.columnItems=b.data.sub.items||null,this.setConfigs(b.data),c=a("#column-"+this.addedColumn),a("#column-0").addClass("hide"),a("#column-1").addClass("collapsed"),c.size()&&(this.currentColumnIdx--,c.remove()),this.showContent=!0,this.addColumn(),this.addedColumn=this.currentColumnIdx):Husky.DEBUG&&console.error(this.name,"showColumn","No data was defined!")},hideColumn:function(){var b;b=a("#column-"+this.addedColumn),b.size()&&(b.remove(),a("#column-0").removeClass("hide"),a("#column-1").removeClass("collapsed")),this.addedColumn=null},scrollLocked:!0,scrollSubColumns:function(a){var b=a.originalEvent.detail<0||a.originalEvent.wheelDelta>0?1:-1,c=25,d=0;a.preventDefault(),this.scrollLocked&&(this.scrollLocked=!1,setTimeout(function(){this.scrollLocked=!0,0>b?(d=this.$navigationSubColumns.scrollLeft()+c,this.$navigationSubColumns.scrollLeft(d)):(d=this.$navigationSubColumns.scrollLeft()-c,this.$navigationSubColumns.scrollLeft(d))}.bind(this),25))},scrollToLastSubColumn:function(){this.$navigationSubColumns.delay(250).animate({scrollLeft:1e3},500)},bindEvents:function(){this.on("navigation:item:column:show",this.showColumn.bind(this))},bindDOMEvents:function(){Husky.DEBUG&&console.log(this.name,"bindDOMEvents"),this.$element.off(),a(b).on("resize load",this.setNavigationSize.bind(this)),this.$element.on("click",".navigation-column-item",this.selectItem.bind(this)),this.$element.on("click",".navigation-column:eq(1)",this.showNavigationColumns.bind(this)),this.$element.on("click",".navigation-column:eq(0).collapsed",this.showFirstNavigationColumn.bind(this)),this.$element.on("mousewheel DOMMouseScroll",".navigation-sub-columns-container",this.scrollSubColumns.bind(this))},render:function(){this.$element.html(this.$navigation),this.bindEvents(),this.bindDOMEvents()},addLoader:function(a){a.addClass("is-loading")},hideLoader:function(a){a.removeClass("is-loading")},collections:{items:function(){return a.extend({},Husky.Collection)}},models:{item:function(b){var c={title:"",hasSub:!1};return a.extend({},Husky.Model,c,b)}},template:{columnHeader:function(a){var b=null;return a=a||{},a.title=a.title||"",a.logo=a.logo||"",a.logo&&(b='<span class="navigation-column-logo"><img alt="'+a.title+'" src="'+a.logo+'"/></span>'),[b,'<h2 class="navigation-column-title">',a.title,"</h2>"].join("")},search:function(a){return a=a||{},a.action=a.action||"",a.icon=a.icon||"",['<input type="text" class="search" autofill="false" data-action="',a.action,'" placeholder="Search ..."/>'].join("")
}}}),a.fn.huskyNavigation=function(b){var d=a(this);return b=a.extend({},a.fn.huskyNavigation.defaults,"object"==typeof b&&b),d.data(c)?this:(d.data(c,new Husky.Ui.Navigation(this,b)),this)},a.fn.huskyNavigation.defaults={url:"",collapse:!1}}(Husky.$,this,this.document),function(a){"use strict";var b="Husky.Ui.Select";Husky.Ui.Select=function(c,d){this.name=b,Husky.DEBUG&&console.log(this.name,"create instance"),this.options=d,this.configs={},this.$originalElement=a(c),this.$element=a('<div class="husky-ui-select"/>'),this.$originalElement.append(this.$element),this.init()},a.extend(Husky.Ui.Select.prototype,Husky.Events,{vent:function(){return a.extend({},Husky.Events)}(),getUrl:function(){return this.options.url},init:function(){Husky.DEBUG&&console.log(this.name,"init"),this.$select=a('<select class="select-value form-element"/>'),this.$element.append(this.$select),this.prepareData(),this.bindDOMEvents()},bindDOMEvents:function(){this.$element.off()},prepareData:function(){this.options.data.length>0?this.generateOptions(this.options.data):this.loadData()},loadData:function(){var a=this.getUrl();Husky.DEBUG&&console.log(this.name,"load: "+a),Husky.Util.ajax({url:a,success:function(a){Husky.DEBUG&&console.log(this.name,"load","success"),this.options.data=a.total>0&&a.items.length==a.total?a.items:[],this.generateOptions(this.options.data)}.bind(this),error:function(){Husky.DEBUG&&console.log(this.name,"load","error"),this.options.data=[],this.generateOptions(this.options.data)}.bind(this)}),setTimeout(function(){this.trigger("select:loadData",null)}.bind(this),200)},generateOptions:function(a){this.clearOptions(),a.forEach(this.generateOption.bind(this))},generateOption:function(b){var c=a('<option value="'+b.id+'">'+b[this.options.valueName]+"</option>");(null!=this.options.selected&&this.options.selected.id==b.id||null==this.options.selected&&this.options.defaultItem.id==b.id)&&c.attr("selected",!0),this.$select.append(c)},clearOptions:function(){this.$select.find("option").remove()}}),a.fn.huskySelect=function(c){var d=a(this);return c=a.extend({},a.fn.huskySelect.defaults,"object"==typeof c&&c),d.data(b)?this:(d.data(b,new Husky.Ui.Select(this,c)),this)},a.fn.huskySelect.defaults={url:"",data:[],valueName:"name",selected:null,defaultItem:{id:1}}}(Husky.$,this,this.document),function(a){"use strict";Husky.Util={ajax:function(b){return b=a.extend({type:"GET"},b),a.ajax(b)},compare:function(a,b){return"array"===typeOf(a)&&"array"===typeOf(b)?JSON.stringify(a)===JSON.stringify(b):void 0},template:function(){}}}(Husky.$,this,this.document);