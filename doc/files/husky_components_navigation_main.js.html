<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>husky_components/navigation/main.js - husky</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="husky"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AutoComplete.html">AutoComplete</a></li>
            
                <li><a href="../classes/AutoCompleteList.html">AutoCompleteList</a></li>
            
                <li><a href="../classes/CKEditor.html">CKEditor</a></li>
            
                <li><a href="../classes/Column-Options.html">Column-Options</a></li>
            
                <li><a href="../classes/ColumnNavigation.html">ColumnNavigation</a></li>
            
                <li><a href="../classes/DataGrid.html">DataGrid</a></li>
            
                <li><a href="../classes/Dependant Select.html">Dependant Select</a></li>
            
                <li><a href="../classes/Label.html">Label</a></li>
            
                <li><a href="../classes/Loader.html">Loader</a></li>
            
                <li><a href="../classes/Matcher.html">Matcher</a></li>
            
                <li><a href="../classes/Overlay.html">Overlay</a></li>
            
                <li><a href="../classes/Process.html">Process</a></li>
            
                <li><a href="../classes/Search.html">Search</a></li>
            
                <li><a href="../classes/Select.html">Select</a></li>
            
                <li><a href="../classes/SmartContent.html">SmartContent</a></li>
            
                <li><a href="../classes/Toggler.html">Toggler</a></li>
            
                <li><a href="../classes/Toolbar.html">Toolbar</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/husky_components_auto-complete.html">husky/components/auto-complete</a></li>
            
                <li><a href="../modules/husky_components_auto-complete-list.html">husky/components/auto-complete-list</a></li>
            
                <li><a href="../modules/husky_components_column-navigation.html">husky/components/column-navigation</a></li>
            
                <li><a href="../modules/husky_components_column-options.html">husky/components/column-options</a></li>
            
                <li><a href="../modules/husky_components_label.html">husky/components/label</a></li>
            
                <li><a href="../modules/husky_components_matcher.html">husky/components/matcher</a></li>
            
                <li><a href="../modules/husky_components_process.html">husky/components/process</a></li>
            
                <li><a href="../modules/husky_components_smart-content.html">husky/components/smart-content</a></li>
            
                <li><a href="../modules/husky_components_toolbar.html">husky/components/toolbar</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: husky_components/navigation/main.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
 * This file is part of the Sulu CMS.
 *
 * (c) MASSIVE ART WebServices GmbH
 *
 * This source file is subject to the MIT license that is bundled
 * with this source code in the file LICENSE.
 *
 * Name: navigation
 *
 * Description:
 *  Navigation Element
 *  also loads search component
 *
 * Options:
 *  footerTemplate - html template to define the footer
 *
 * Provides Events:
 *  husky.navigation.footer.set - set template
 *
 * Triggers Events:
 *  husky.navigation.item.select - {item}
 *  husky.navigation.item.toggle - isExpanded, {item}
 *  husky.navigation.item.settings - {item}
 *
 */

// TODO: arrow keys
// TODO: action as link for ux -&gt; footer where it will link
// TODO: cogwheel at dashboard in the middle
// TODO: events as specified
// TODO: move functions into private space
// TODO: cleanup css-classes
// TODO: complete yui-doc

define(function() {

    &#x27;use strict&#x27;;

    var templates = {
            /** component skeleton */
            skeleton: [
                &#x27;&lt;nav class=&quot;navigation&lt;% if (collapsed === &quot;true&quot;) {%&gt; collapsed&lt;% } %&gt;&quot;&gt;&#x27;,
                &#x27;   &lt;div class=&quot;navigation-content&quot;&gt;&#x27;,
                &#x27;       &lt;div class=&quot;wrapper&quot;&gt;&#x27;,
                &#x27;           &lt;header class=&quot;navigation-header&quot;&gt;&#x27;,
                &#x27;               &lt;div class=&quot;navigation-header-title&quot;&gt;&lt;% if (data.title) { %&gt; &lt;%= translate(data.title) %&gt;&lt;% } %&gt;&lt;/div&gt;&#x27;,
                &#x27;           &lt;/header&gt;&#x27;,
                &#x27;           &lt;div id=&quot;navigation-search&quot; class=&quot;navigation-search&quot;&gt;&lt;/div&gt;&#x27;,
                &#x27;           &lt;div id=&quot;navigation-item-container&quot; class=&quot;navigation-item-container&quot;&gt;&lt;/div&gt;&#x27;,
                &#x27;       &lt;/div&gt;&#x27;,
                &#x27;       &lt;footer&gt;&#x27;,
                &#x27;       &lt;/footer&gt;&#x27;,
                &#x27;   &lt;/div&gt;&#x27;,
                &#x27;   &lt;div class=&quot;icon-remove2 navigation-close-icon&quot;&gt;&#x27;,
                &#x27;&lt;/nav&gt;&#x27;].join(&#x27;&#x27;),
            headerImage: [
                &#x27;&lt;div class=&quot;navigation-header-image&quot;&gt;&#x27;,
                &#x27;   &lt;img alt=&quot;#&quot; src=&quot;&lt;%= icon %&gt;&quot;/&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),
            headerText: [
                &#x27;&lt;div class=&quot;navigation-header-text&quot;&gt;&lt;span&gt;&lt;%= text %&gt;&lt;/span&gt;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;),
            /** main navigation items (with icons)*/
            mainItem: [
                &#x27;&lt;li class=&quot;js-navigation-items navigation-items&quot; id=&quot;&lt;%= item.id %&gt;&quot; data-id=&quot;&lt;%= item.id %&gt;&quot;&gt;&#x27;,
                &#x27;   &lt;div &lt;% if (item.items &amp;&amp; item.items.length &gt; 0) { %&gt; class=&quot;navigation-items-toggle&quot; &lt;% } %&gt; &gt;&#x27;,
                &#x27;       &lt;a class=&quot;&lt;% if (!!item.action) { %&gt;js-navigation-item &lt;% } %&gt;navigation-item&quot; href=&quot;#&quot;&gt;&#x27;,
                &#x27;           &lt;span class=&quot;&lt;%= icon %&gt; navigation-item-icon&quot;&gt;&lt;/span&gt;&#x27;,
                &#x27;           &lt;span class=&quot;navigation-item-title&quot;&gt;&lt;%= translate(item.title) %&gt;&lt;/span&gt;&#x27;,
                &#x27;       &lt;/a&gt;&#x27;,
                &#x27;       &lt;% if (item.hasSettings) { %&gt;&#x27;,
                &#x27;           &lt;a class=&quot;icon-cogwheel navigation-settings-icon js-navigation-settings&quot; id=&quot;&lt;%= item.id %&gt;&quot; href=&quot;#&quot;&gt;&lt;/a&gt;&#x27;,
                &#x27;       &lt;% } %&gt;&#x27;,
                &#x27;       &lt;% if (item.items &amp;&amp; item.items.length &gt; 0) { %&gt;&#x27;,
                &#x27;           &lt;a class=&quot;icon-chevron-right navigation-toggle-icon&quot; href=&quot;#&quot;&gt;&lt;/a&gt;&#x27;,
                &#x27;       &lt;% } %&gt;&#x27;,
                &#x27;   &lt;/div&gt;&#x27;,
                &#x27;&lt;/li&gt;&#x27;].join(&#x27;&#x27;),
            /** sub navigation items */
            subToggleItem: [
                &#x27;   &lt;li class=&quot;js-navigation-items navigation-subitems&quot; id=&quot;&lt;%= item.id %&gt;&quot; data-id=&quot;&lt;%= item.id %&gt;&quot;&gt;&#x27;,
                &#x27;       &lt;div class=&quot;navigation-subitems-toggle&quot;&gt;&#x27;,
                &#x27;           &lt;a class=&quot;&lt;% if (!!item.action) { %&gt;js-navigation-item &lt;% } %&gt; navigation-item&quot; href=&quot;#&quot;&gt;&lt;%= translate(item.title) %&gt;&lt;/a&gt;&#x27;,
                &#x27;           &lt;% if (item.hasSettings) { %&gt;&#x27;,
                &#x27;           &lt;a class=&quot;icon-cogwheel navigation-settings-icon js-navigation-settings&quot; href=&quot;#&quot;&gt;&lt;/a&gt;&#x27;,
                &#x27;           &lt;% } %&gt;&#x27;,
                &#x27;           &lt;a class=&quot;icon-chevron-right navigation-toggle-icon&quot; href=&quot;#&quot;&gt;&lt;/a&gt;&#x27;,
                &#x27;       &lt;/div&gt;&#x27;,
                &#x27;&lt;/li&gt;&#x27;].join(&#x27;&#x27;),
            /** siple sub item */
            subItem: [
                &#x27;&lt;li class=&quot;js-navigation-sub-item&quot; id=&quot;&lt;%= item.id %&gt;&quot; data-id=&quot;&lt;%= item.id %&gt;&quot;&gt;&#x27;,
                &#x27;   &lt;a href=&quot;#&quot;&gt;&lt;%= translate(item.title) %&gt;&lt;/a&gt;&#x27;,
                &#x27;&lt;/li&gt;&#x27;
            ].join(&#x27;&#x27;),
            //footer template
            footer: [
                &#x27;&lt;div class=&quot;user&quot;&gt;&#x27;,
                &#x27;&lt;div class=&quot;icon-user pic&quot;&gt;&lt;/div&gt;&#x27;,
                &#x27;&lt;div class=&quot;name&quot;&gt;&lt;%= userName %&gt;&lt;/div&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;,
                &#x27;&lt;div class=&quot;options&quot;&gt;&#x27;,
                &#x27;&lt;div class=&quot;locale-dropdown&quot;&gt;&lt;/div&gt;&#x27;,
                &#x27;&lt;a href=&quot;&lt;%= logoutRoute %&gt;&quot; title=&quot;Logout&quot; class=&quot;icon-lock logout&quot;&gt;&lt;/a&gt;&#x27;,
                &#x27;&lt;/div&gt;&#x27;,
                &#x27;&lt;div class=&quot;version&quot;&gt;&lt;%= system %&gt; (&lt;%= version %&gt;, &lt;a href=&quot;#&quot;&gt;&lt;%= versionHistory %&gt;&lt;/a&gt;)&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;)
        },
        defaults = {
            footerTemplate: &#x27;&#x27;,
            collapsed: false,
            labels: {
                hide: &#x27;navigation.hide&#x27;,
                show: &#x27;navigation.show&#x27;
            },
            resizeWidth: 800,
            forceCollapse: false,
            systemName: &#x27;Sulu 2.0&#x27;,
            footer: true,
            logoutRoute: &#x27;/logout&#x27;,
            translations: {
                versionHistory: &#x27;navigation.version-history&#x27;,
                user: &#x27;navigation.user&#x27;
            }
        },
        CONSTANTS = {
            UNCOLLAPSED_WIDTH: 250, //px
            COLLAPSED_WIDTH: 50, //px
            ITEM_LABEL_HEIGHT: 50, //px
            TRANSITIONEND_EVENT: &#x27;transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd&#x27;
        },

        namespace = &#x27;husky.navigation.&#x27;,

        /**
         * listens on and activates the matching navigation-item
         * @event husky.navigation.select-item
         * @param {string} selectAction The select-action to match the navigation-item for
         */
            EVENT_SELECT_ITEM = namespace + &#x27;select-item&#x27;,

        /**
         * raised when navigation was collapsed
         * @event husky.navigation.collapsed
         * @param {Number} width The width of the collapsed navigation
         */
            EVENT_COLLAPSED = namespace + &#x27;collapsed&#x27;,

        /**
         * raised when navigation was un-collapsed
         * @event husky.navigation.uncollapsed
         * @param {Number} width The width of the un-collapsed navigation
         */
            EVENT_UNCOLLAPSED = namespace + &#x27;uncollapsed&#x27;,


        /**
         * forces navigation to collapse
         * @event husky.navigation.collapse
         * @param {Boolean} stayCollapsed - if true the navigation stays collapsed till the custom-uncollapse event is emited
         */
            EVENT_COLLAPSE = namespace + &#x27;collapse&#x27;,

        /**
         * forces navigation to uncollapse
         * @event husky.navigation.uncollapse
         * @param {Bool} force If true, the navigation will act as overflow and collapse again after interaction
         */
            EVENT_UNCOLLAPSE = namespace + &#x27;uncollapse&#x27;,


        /**
         * raised when navigation collapse / uncollapse of navigation is triggered. called before transition starts
         * only raised when not forced
         * @event husky.navigation.size.change
         */
            EVENT_SIZE_CHANGE = namespace + &#x27;size.change&#x27;,

        /**
         * raised when navigation was un / collapsed. called when transition is finished. only raised when not forced
         * @event husky.navigation.size.changed
         */
            EVENT_SIZE_CHANGED = namespace + &#x27;size.changed&#x27;,

        /**
         * raised when the user locale is changed
         * @event husky.navigation.user-locale.changed
         */
            USER_LOCALE_CHANGED = namespace + &#x27;user-locale.changed&#x27;,

        /**
         * raised when the version history is clicked
         * @event husky.navigation.version-history.clicked
         */
            VERSION_HISTORY_CLICKED = namespace + &#x27;version-history.clicked&#x27;,

        /**
         * show the navigation when it was hidden before
         * @event husky.navigation.show
         */
            EVENT_SHOW = namespace + &#x27;show&#x27;,

        /**
         * triggers the update of the navigation size
         * @event husky.navigation.show.size
         */
            EVENT_SIZE_UPDATE = namespace + &#x27;size.update&#x27;,

        /**
         * hides the navigation completely
         * @event husky.navigation.hide
         */
            EVENT_HIDE = namespace + &#x27;hide&#x27;
        ;


    return {

        initialize: function() {

            this.sandbox.logger.log(&#x27;Initialized Navigation&#x27;);

            // merging options
            this.options = this.sandbox.util.extend(true, {}, defaults, this.options);

            this.stayCollapsed = false;
            this.hidden = false;
            this.tooltipsEnabled = true;
            this.animating = false;

            // binding dom events
            this.bindDOMEvents();

            this.bindCustomEvents();

            // load Data
            if (!!this.options.url) {
                this.sandbox.util.load(this.options.url)
                    .then(this.render.bind(this))
                    .fail(function(data) {
                        this.sandbox.logger.log(&quot;data could not be loaded:&quot;, data);
                    }.bind(this));
            }
        },

        /**
         * renders the navigation
         * gets called after navigation data was loaded
         * @param data
         */
        render: function(data) {

            // data storage
            this.options.data = data;

            // array to save all navigation items
            this.items = [];

            // add container class to current div
            this.sandbox.dom.addClass(this.$el, &#x27;navigation-container&#x27;);

            // render skeleton
            this.sandbox.dom.html(this.$el, this.sandbox.template.parse(templates.skeleton,
                this.sandbox.util.extend(true, {}, this.options, {translate: this.sandbox.translate}))
            );

            // render header image
            if (typeof this.options.data.icon === &#x27;string&#x27;) {
                this.sandbox.dom.prepend(this.sandbox.dom.find(&#x27;header.navigation-header&#x27;, this.$el),
                    this.sandbox.template.parse(templates.headerImage, {
                        icon: this.options.data.icon
                    })
                );
            } else {
                this.sandbox.dom.prepend(this.sandbox.dom.find(&#x27;header.navigation-header&#x27;, this.$el),
                    this.sandbox.template.parse(templates.headerText, {
                        text: this.options.data.title.substr(0, 1)
                    })
                );
            }

            this.$navigation = this.$find(&#x27;.navigation&#x27;, this.$el);
            this.$navigationContent = this.$find(&#x27;.navigation-content&#x27;, this.$navigation);

            // start search component
            this.sandbox.start([
                {
                    name: &#x27;search@husky&#x27;,
                    options: {
                        el: &#x27;#navigation-search&#x27;,
                        placeholderText: &#x27;public.search&#x27;
                    }
                }
            ]);

            // render navigation items
            this.renderNavigationItems(this.options.data);

            // render footer
            this.renderFooter();

            // collapse if necessary
            this.resizeListener();

            // preselect item based on url
            if (!!this.options.selectAction &amp;&amp; this.options.selectAction.length &gt; 0) {
                this.preselectItem(this.options.selectAction);
            }

            // emit initialized event
            this.sandbox.emit(&#x27;husky.navigation.initialized&#x27;);
        },

        /**
         *  renders main navigation elements
         */
        renderNavigationItems: function(data) {
            var $elem, $sectionDiv, $sectionList;
            // iterate through sections
            this.sandbox.util.foreach(data.items, function(section) {
                $sectionDiv = this.sandbox.dom.createElement(&#x27;&lt;div class=&quot;section&quot;&gt;&#x27;);
                $sectionList = this.sandbox.dom.createElement(&#x27;&lt;ul class=&quot;section-items&quot;&gt;&#x27;);

                if (!!section.title) {
                    this.sandbox.dom.append($sectionDiv, &#x27;&lt;div class=&quot;section-headline&quot;&gt;&lt;span class=&quot;section-headline-title&quot;&gt;&#x27; + this.sandbox.translate(section.title).toUpperCase() + &#x27;&lt;/span&gt;&lt;span class=&quot;section-toggle&quot;&gt;&lt;a href=&quot;#&quot;&gt;&#x27; + this.sandbox.translate(this.options.labels.hide) + &#x27;&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&#x27;);
                }

                this.sandbox.dom.append($sectionDiv, $sectionList);
                this.sandbox.dom.append(&#x27;#navigation-item-container&#x27;, $sectionDiv);

                // iterate through section items
                this.sandbox.util.foreach(section.items, function(item) {
                    // create item
                    $elem = this.sandbox.dom.createElement(this.sandbox.template.parse(templates.mainItem, {
                        item: item,
                        icon: item.icon ? &#x27;icon-&#x27; + item.icon : &#x27;&#x27;,
                        translate: this.sandbox.translate
                    }));
                    this.sandbox.dom.append($sectionList, $elem);
                    //render sub-items
                    if (item.items &amp;&amp; item.items.length &gt; 0) {
                        this.renderSubNavigationItems(item, $elem);
                    }
                    item.domObject = $elem;
                    this.items.push(item);
                }.bind(this));
            }.bind(this));
        },

        /**
         * renders sub-navigation elements
         */
        renderSubNavigationItems: function(data, $parentList) {
            var elem,
                textCont,
                list = this.sandbox.dom.createElement(&#x27;&lt;ul class=&quot;navigation-items-list&quot; /&gt;&#x27;);

            this.sandbox.dom.append($parentList, list);

            this.sandbox.util.foreach(data.items, function(item) {
                item.parentTitle = data.title;
                this.items.push(item);
                if (item.items &amp;&amp; item.items.length &gt; 0) {
                    elem = this.sandbox.dom.createElement(this.sandbox.template.parse(templates.subToggleItem, {item: item, translate: this.sandbox.translate}));
                    this.renderSubNavigationItems(item, this.sandbox.dom.find(&#x27;div&#x27;, elem));
                } else {
                    elem = this.sandbox.dom.createElement(this.sandbox.template.parse(templates.subItem, {item: item, translate: this.sandbox.translate}));
                }
                this.sandbox.dom.append(list, elem);

                // add tooltip
                textCont = this.sandbox.dom.find(&#x27;a&#x27;, elem);
                if (this.sandbox.dom.width(textCont) + 20 &lt; this.sandbox.dom.get(textCont, 0).scrollWidth) {
                    this.sandbox.dom.attr(textCont, {&#x27;title&#x27;: this.sandbox.dom.html(textCont)});
                }

                item.domObject = elem;
            }.bind(this));
        },

        /**
         * Renders the footer of the navigation
         */
        renderFooter: function() {
            if (this.options.footer === true) {
                var $footer = this.sandbox.dom.find(&#x27;footer&#x27;, this.$el);
                this.sandbox.dom.html($footer, _.template(templates.footer)({
                    userName: this.options.userName,
                    system: this.options.systemName,
                    version: this.options.systemVersion,
                    versionHistory: this.sandbox.translate(this.options.translations.versionHistory),
                    logoutRoute: this.options.logoutRoute
                }));

                this.sandbox.start([
                    {
                        name: &#x27;select@husky&#x27;,
                        options: {
                            el: this.sandbox.dom.find(&#x27;.locale-dropdown&#x27;, $footer),
                            instanceName: &#x27;navigation-locale&#x27;,
                            value: &#x27;name&#x27;,
                            data: this.options.userLocales,
                            preSelectedElements: [this.options.userLocale],
                            style: &#x27;small&#x27;,
                            emitValues: true
                        }
                    }
                ]);
            }
        },

        /**
         * Handles the event when the collapsed Footer is clicked
         */
        collapsedFooterClickHandler: function() {
            this.unCollapse(true);

            // scroll to footer
            this.sandbox.dom.one(this.sandbox.dom.$window, CONSTANTS.TRANSITIONEND_EVENT,
                this.checkBottomHit.bind(this, null, this.sandbox.dom.find(&#x27;footer&#x27;, this.$el)));
        },

        /**
         * Interaction
         */
        bindDOMEvents: function() {
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, this.toggleItems.bind(this), &#x27;.navigation-items-toggle, .navigation-subitems-toggle&#x27;);
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, this.toggleSections.bind(this), &#x27;.section-toggle&#x27;);
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, this.settingsClicked.bind(this), &#x27;.js-navigation-settings&#x27;);
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, this.selectSubItem.bind(this), &#x27;.js-navigation-sub-item, .js-navigation-item&#x27;);

            // collapse events
            this.sandbox.dom.on(this.sandbox.dom.window, &#x27;resize&#x27;, this.resizeListener.bind(this));
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, this.showCollapsedSearch.bind(this), &#x27;.navigation #navigation-search a.search-icon&#x27;);
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, this.collapse.bind(this), &#x27;.navigation.collapseIcon .navigation-close-icon&#x27;);
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, this.collapsedFooterClickHandler.bind(this), &#x27;.navigation.collapsed footer&#x27;);


            // tooltip events
            this.sandbox.dom.on(this.$el, &#x27;mouseenter&#x27;, function(event) {
                this.showToolTip.call(this, this.sandbox.dom.attr(this.sandbox.dom.find(&#x27;input&#x27;, &#x27;.navigation-search&#x27;), &#x27;placeholder&#x27;), event);
            }.bind(this), &#x27;.navigation.collapsed .navigation-search&#x27;);
            this.sandbox.dom.on(this.$el, &#x27;mouseenter&#x27;, function(event) {
                this.showToolTip.call(this, this.sandbox.translate(this.options.translations.user), event);
            }.bind(this), &#x27;.navigation.collapsed footer&#x27;);
            this.sandbox.dom.on(this.$el, &#x27;mouseenter&#x27;, this.showToolTip.bind(this, &#x27;&#x27;), &#x27;.navigation.collapsed .navigation-items&#x27;);
            this.sandbox.dom.on(this.$el, &#x27;mouseleave&#x27;, this.hideToolTip.bind(this), &#x27;.navigation.collapsed .navigation-items, .navigation.collapsed .navigation-search, .navigation.collapsed footer&#x27;);

            this.sandbox.dom.on(this.$el, CONSTANTS.TRANSITIONEND_EVENT, function() {
                this.sandbox.emit(EVENT_SIZE_CHANGED, this.sandbox.dom.width(this.$navigation));
                this.tooltipsEnabled = true;
            }.bind(this));
            this.sandbox.dom.on(this.$el, CONSTANTS.TRANSITIONEND_EVENT, function(event) {
                event.stopPropagation();
            }.bind(this), &#x27;.navigation *&#x27;);

            // version history clicked
            this.sandbox.dom.on(this.$el, &#x27;click&#x27;, function() {
                this.sandbox.emit(VERSION_HISTORY_CLICKED);
            }.bind(this), &#x27;footer .version a&#x27;);
        },

        /**
         * event listener
         */
        bindCustomEvents: function() {
            // merge options with newly passed options and rerender footer
            this.sandbox.on(&#x27;husky.navigation.footer.set&#x27;, function(options) {
                this.options = this.sandbox.util.extend(true, {}, this.options, options);
                this.renderFooter();
            }.bind(this));

            //user locales dropdown
            this.sandbox.on(&#x27;husky.select.navigation-locale.selected.item&#x27;, function(locale) {
                this.sandbox.emit(USER_LOCALE_CHANGED, locale);
            }.bind(this));

            this.sandbox.on(EVENT_COLLAPSE, function(stayCollapsed) {
                this.stayCollapsed = (typeof stayCollapsed === &#x27;boolean&#x27;) ? stayCollapsed : false;
                this.collapse();
            }.bind(this));
            this.sandbox.on(EVENT_UNCOLLAPSE, function(force) {
                this.stayCollapsed = false;
                this.unCollapse(force);
            }.bind(this));

            this.sandbox.on(EVENT_HIDE, this.hide.bind(this));
            this.sandbox.on(EVENT_SHOW, this.show.bind(this));

            this.sandbox.on(EVENT_SIZE_UPDATE, this.resizeListener.bind(this));

            this.sandbox.on(EVENT_SELECT_ITEM, this.preselectItem.bind(this));
        },

        resizeListener: function() {
            var windowWidth = this.sandbox.dom.width(this.sandbox.dom.window);

            if (windowWidth &lt;= this.options.resizeWidth || this.stayCollapsed === true) {
                this.collapse();
            } else if (this.sandbox.dom.hasClass(this.$navigation, &#x27;collapsed&#x27;)) {
                this.unCollapse();
            }
        },

        showToolTip: function(title, event) {
            if (this.tooltipsEnabled === true) {
                var offset,
                    target = event.currentTarget;

                if (!title) {
                    title = this.sandbox.dom.html(this.sandbox.dom.find(&#x27;.navigation-item-title&#x27;, event.currentTarget));
                }
                if (!this.$tooltip) {
                    this.$tooltip = this.sandbox.dom.createElement(&#x27;&lt;div class=&quot;navigation-tooltip&quot;&gt;&#x27; + title + &#x27;&lt;/div&gt;&#x27;);
                    this.sandbox.dom.append(&#x27;body&#x27;, this.$tooltip);
                }
                offset = this.sandbox.dom.offset(target);
                this.sandbox.dom.css(this.$tooltip, {
                    top: offset.top + (this.sandbox.dom.outerHeight(target) - 30) / 2
                });
            }
        },

        hideToolTip: function() {
            if (!!this.$tooltip) {
                this.sandbox.dom.remove(this.$tooltip);
                this.$tooltip = null;
            }
        },


        /**
         * Takes an action and select the matching navigation point
         * @param selectAction {string}
         */
        preselectItem: function(selectAction) {
            var matchLength = 0, matchItem, parent, match;
            this.sandbox.util.foreach(this.items, function(item) {
                if (!item || !item.action) {
                    return;
                }
                if (selectAction.indexOf(item.action) !== -1 &amp;&amp; item.action.length &gt; matchLength) {
                    matchItem = item;
                    matchLength = item.action.length;
                }
            }.bind(this));

            if (matchLength &gt; 0) {
                match = matchItem.domObject;

                if (this.sandbox.dom.hasClass(match, &#x27;js-navigation-sub-item&#x27;)) {
                    parent = this.sandbox.dom.closest(match, &#x27;.navigation-items&#x27;);
                    this.toggleItems(null, parent);
                }
                this.selectSubItem(null, match, false);
                this.checkBottomHit(null, match);
            }
        },


        /**
         * gets called when settings icon is clicked
         * @emits husky.navigation.item.settings (name, id, parent)
         * @param event
         */
        settingsClicked: function(event) {

            event.stopPropagation();
            event.preventDefault();

            // emit event
            var listItem = this.sandbox.dom.closest(event.currentTarget, &#x27;.js-navigation-items&#x27;),
                item = this.getItemById(this.sandbox.dom.data(listItem, &#x27;id&#x27;));

            this.sandbox.emit(&#x27;husky.navigation.item.settings&#x27;, item);

        },

        /**
         * Toggles menu element with submenu
         * Raises navigation.toggle
         * @param event
         * @param customTarget
         */
        toggleItems: function(event, customTarget) {

            if (event) {
                event.preventDefault();
            } else {
                event = {
                    currentTarget: customTarget
                };
            }

            var $items = this.sandbox.dom.closest(event.currentTarget, &#x27;.js-navigation-items&#x27;),
                $childList = this.sandbox.dom.find(&#x27;ul:first&#x27;, $items),
                item, $toggle,
                isExpanded = this.sandbox.dom.hasClass($items, &#x27;is-expanded&#x27;),
                navWasCollapsed;

            // only check collapse if event was fired
            if (!customTarget) {
                navWasCollapsed = this.showIfCollapsed();
            }

            if (isExpanded &amp;&amp; !navWasCollapsed) {
                $toggle = this.sandbox.dom.find(&#x27;.icon-chevron-down&#x27;, event.currentTarget);
                this.animateSlideUp($items, $toggle);
            } else if (this.collapsed !== true) {
                $toggle = this.sandbox.dom.find(&#x27;.icon-chevron-right&#x27;, event.currentTarget);
                this.animateSlideDown($items, $toggle, $childList);
            }

            // emit event
            item = this.getItemById(this.sandbox.dom.data($items, &#x27;id&#x27;));
            this.sandbox.emit(&#x27;husky.navigation.item.toggle&#x27;, !isExpanded, item);
        },

        /**
         * Handles the slide-up animation
         * @param $items
         * @param $toggle
         */
        animateSlideUp: function($items, $toggle) {
            if (this.animating === false) {
                this.animating = true;

                this.sandbox.dom.animate($items, {
                    height: CONSTANTS.ITEM_LABEL_HEIGHT
                }, {
                    duration: 180,
                    complete: function() {
                        this.animating = false;
                    }.bind(this)
                });

                this.sandbox.dom.removeClass($items, &#x27;is-expanded&#x27;);

                // change toggle item
                this.sandbox.dom.removeClass($toggle, &#x27;icon-chevron-down&#x27;);
                this.sandbox.dom.prependClass($toggle, &#x27;icon-chevron-right&#x27;);
            }
        },

        /**
         * Handles the slide-down animation
         * @param $items
         * @param $toggle
         * @param $childList
         */
        animateSlideDown: function($items, $toggle, $childList) {
            if (this.animating === false) {
                this.animating = true;
                var expandedHeight = CONSTANTS.ITEM_LABEL_HEIGHT + this.sandbox.dom.outerHeight($childList);

                $($items).stop();
                this.sandbox.dom.animate($items, {
                    height: (expandedHeight + 30)
                }, {
                    duration: 120
                });

                this.sandbox.dom.animate($items, {
                    height: expandedHeight
                }, {
                    duration: 100,
                    complete: function() {
                        this.animating = false;
                    }.bind(this)
                });

                this.sandbox.dom.addClass($items, &#x27;is-expanded&#x27;);

                // change toggle item
                this.sandbox.dom.removeClass($toggle, &#x27;icon-chevron-right&#x27;);
                this.sandbox.dom.prependClass($toggle, &#x27;icon-chevron-down&#x27;);

                this.sandbox.dom.one($items, CONSTANTS.TRANSITIONEND_EVENT, this.checkBottomHit.bind(this));
            }
        },

        checkBottomHit: function(event, customTarget) {
            var xBottom, windowHeight, itemHeight, itemTop, scrollTop,
                $items;

            if (event) {
                $items = event.currentTarget;
            } else {
                $items = customTarget;
            }
            // check if collapsed element overlaps browser border
            itemTop = this.sandbox.dom.offset($items).top;
            itemHeight = this.sandbox.dom.height($items);
            xBottom = itemTop + itemHeight;
            windowHeight = this.sandbox.dom.height(this.sandbox.dom.window);
            scrollTop = this.sandbox.dom.scrollTop(this.$navigationContent);
            if (xBottom &gt; windowHeight) {
                if (itemHeight &lt; windowHeight) {
                    this.sandbox.dom.scrollAnimate(scrollTop + (xBottom - windowHeight + 40), this.$navigationContent);
                } else {
                    this.sandbox.dom.scrollAnimate(itemTop, this.$navigationContent);
                }
            }
        },

        /**
         * Removes the inline-style for expanded items
         */
        removeHeightforExpanded: function() {
            var $expandedItems = this.sandbox.dom.find(&#x27;.is-expanded&#x27;, this.$el), i, length;
            for (i = -1, length = $expandedItems.length; ++i &lt; length;) {
                this.sandbox.dom.removeAttr($expandedItems[i], &#x27;style&#x27;);
            }
        },

        /**
         * Resets the inline-style height for expanded items
         */
        setHeightForExpanded: function() {
            var $expandedItems = this.sandbox.dom.find(&#x27;.is-expanded&#x27;, this.$el),
                height, i, length;
            for (i = -1, length = $expandedItems.length; ++i &lt; length;) {
                height = CONSTANTS.ITEM_LABEL_HEIGHT + this.sandbox.dom.outerHeight(
                    this.sandbox.dom.find(&#x27;.navigation-items-list&#x27;, $expandedItems[i]));

                this.sandbox.dom.css($expandedItems[i], {
                    &#x27;height&#x27;: height
                });
            }
        },

        /**
         * toggles sections
         * @param event
         */
        toggleSections: function(event) {

            event.preventDefault();

            var $section = this.sandbox.dom.closest(event.currentTarget, &#x27;.section&#x27;),
                $list = this.sandbox.dom.find(&#x27;.section-items&#x27;, $section),
                toggleLink = this.sandbox.dom.find(&#x27;a&#x27;, event.currentTarget);


            if (this.sandbox.dom.hasClass($section, &#x27;is-hidden&#x27;)) {
                // hide section
                this.sandbox.dom.slideDown($list, 200, function() {
                    this.sandbox.dom.html(toggleLink, this.sandbox.translate(this.options.labels.hide));
                    this.sandbox.dom.removeClass($section, &#x27;is-hidden&#x27;);
                }.bind(this));
            } else {
                // show section
                this.sandbox.dom.html(toggleLink, this.sandbox.translate(this.options.labels.show));
                this.sandbox.dom.slideUp($list, 200, function() {
                    this.sandbox.dom.addClass($section, &#x27;is-hidden&#x27;);
                }.bind(this));
            }

            this.sandbox.emit(&#x27;husky.navigation.section.toggle&#x27;);
        },

        // returns if nav was collapsed
        showIfCollapsed: function() {

            if (this.sandbox.dom.hasClass(this.$navigation, &#x27;collapsed&#x27;)) {
                this.unCollapse(true);
                return true;
            }
            return false;
        },

        collapse: function() {
            if (this.hidden === false) {
                this.sandbox.dom.addClass(this.$navigation, &#x27;collapsed&#x27;);
                this.sandbox.dom.removeClass(this.$navigation, &#x27;collapseIcon&#x27;);
                this.removeHeightforExpanded();
                if (!this.collapsed) {
                    this.sandbox.emit(EVENT_COLLAPSED, CONSTANTS.COLLAPSED_WIDTH);
                    this.sandbox.emit(EVENT_SIZE_CHANGE, CONSTANTS.COLLAPSED_WIDTH);
                    this.collapsed = !this.collapsed;
                    this.tooltipsEnabled = false;
                }
            }
        },

        unCollapse: function(forced) {
            if ((this.stayCollapsed === false || forced === true) &amp;&amp; this.hidden === false) {
                this.sandbox.dom.removeClass(this.$navigation, &#x27;collapsed&#x27;);
                this.hideToolTip();
                this.setHeightForExpanded();
                if (forced) {
                    this.sandbox.dom.addClass(this.$navigation, &#x27;collapseIcon&#x27;);
                }
                if (this.collapsed) {
                    this.sandbox.emit(EVENT_UNCOLLAPSED, CONSTANTS.UNCOLLAPSED_WIDTH);
                    if (!forced) {
                        this.sandbox.emit(EVENT_SIZE_CHANGE, CONSTANTS.UNCOLLAPSED_WIDTH);
                    }
                    this.collapsed = !this.collapsed;
                    this.tooltipsEnabled = false;
                }
            }
        },

        // called when search icon was clicked
        showCollapsedSearch: function(event) {

            // remove collapse
            this.unCollapse(true);

            // focus search
            var input = this.sandbox.dom.find(&#x27;input&#x27;, this.sandbox.dom.parent(event.currentTarget)),
                instanceName;
            this.sandbox.dom.trigger(input, &#x27;focus&#x27;);

            // close when search is sent
            instanceName = this.options.searchInstanceName ? this.options.searchInstanceName + &#x27;.&#x27; : &#x27;&#x27;;
            this.sandbox.once(&#x27;husky.&#x27; + instanceName + &#x27;search&#x27;, this.resizeListener.bind(this));
        },


        /**
         * Selects menu element without submenu
         * Raises navigation.select
         * @param event
         * @param [customTarget] if event is undefined, the target must be passed customly
         * @param emit
         */
        selectSubItem: function(event, customTarget, emit) {

            if (!!event) {
                event.preventDefault();
            } else {
                event = {
                    currentTarget: customTarget
                };
            }

            var $subItem = this.sandbox.dom.createElement(event.currentTarget),
                $items = this.sandbox.dom.parents(event.currentTarget, &#x27;.js-navigation-items&#x27;),
                $parent = this.sandbox.dom.parent(event.currentTarget),
                item;


            if (this.sandbox.dom.hasClass($subItem, &#x27;js-navigation-item&#x27;)) {
                $subItem = this.sandbox.dom.createElement(this.sandbox.dom.closest(event.currentTarget, &#x27;li&#x27;));
            }

            // if toggle was clicked, do not set active and selected
            if (this.sandbox.dom.hasClass($parent, &#x27;navigation-items-toggle&#x27;) || this.sandbox.dom.hasClass($parent, &#x27;navigation-subitems-toggle&#x27;)) {
                return;
            }

            this.sandbox.dom.removeClass(this.sandbox.dom.find(&#x27;.is-selected&#x27;, this.$el), &#x27;is-selected&#x27;);
            this.sandbox.dom.addClass($subItem, &#x27;is-selected&#x27;);

            this.sandbox.dom.removeClass(this.sandbox.dom.find(&#x27;.is-active&#x27;, this.$el), &#x27;is-active&#x27;);
            this.sandbox.dom.addClass($items, &#x27;is-active&#x27;);


            if (emit !== false) {
                // emit event
                item = this.getItemById(this.sandbox.dom.data($subItem, &#x27;id&#x27;));
                this.sandbox.emit(&#x27;husky.navigation.item.select&#x27;, item);
            }


            if (!customTarget) {
                setTimeout(this.resizeListener.bind(this), 700);
            }

        },

        /**
         * Takes an id and returns the matching item
         * @param id {number|string} id of the item
         * @returns {object|null}
         */
        getItemById: function(id) {
            for (var i = -1, length = this.items.length; ++i &lt; length;) {
                if (id === this.items[i].id) {
                    return this.items[i];
                }
            }
            return null;
        },

        /**
         * Shows the navigation
         */
        show: function() {
            if (!!this.currentNavigationWidth) {
                this.sandbox.dom.removeAttr(this.$navigation, &#x27;style&#x27;);
                this.currentNavigationWidth = null;
                this.hidden = false;
            }
        },

        /**
         * Hides the navigaiton
         */
        hide: function() {
            this.currentNavigationWidth = this.sandbox.dom.width(this.$navigation);
            this.sandbox.dom.width(this.$navigation, 0);
            this.hidden = true;
        }

    };

});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
